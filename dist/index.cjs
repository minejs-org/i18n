'use strict';Object.defineProperty(exports,'__esModule',{value:true});var u=class{constructor(t){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.fallbackLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;t&&(this.defaultLanguage=t.defaultLanguage||"en",this.fallbackLanguage=t.fallbackLanguage||t.defaultLanguage||"en",this.currentLanguage=t.defaultLanguage||"en",this.storage=t.storage,this.onLanguageChange=t.onLanguageChange,t.supportedLanguages&&(this.supportedLanguages=new Set(t.supportedLanguages)));}async init(){if(this.storage){let t=await this.storage.get("i18n-language");t&&this.supportedLanguages.has(t)&&(this.currentLanguage=t);}}loadLanguage(t,e){this.translations[t]||(this.translations[t]={});let n=this.flattenObject(e);this.translations[t]={...this.translations[t],...n},this.supportedLanguages.add(t);}loadTranslations(t){Object.entries(t).forEach(([e,n])=>{this.loadLanguage(e,n);});}flattenObject(t,e=""){let n={};for(let s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;let i=t[s],r=e?`${e}.${s}`:s;typeof i=="object"&&i!==null&&!Array.isArray(i)?Object.assign(n,this.flattenObject(i,r)):n[r]=String(i);}return n}t(t,e){let n=this.getTranslation(t);return e&&Object.entries(e).forEach(([s,i])=>{let r=this.getTranslation(i,i);n=n.replace(new RegExp(`\\{${s}\\}`,"g"),r);}),n}getTranslation(t,e){return this.translations[this.currentLanguage]?.[t]?this.translations[this.currentLanguage][t]:this.fallbackLanguage!==this.currentLanguage&&this.translations[this.fallbackLanguage]?.[t]?this.translations[this.fallbackLanguage][t]:this.defaultLanguage!==this.currentLanguage&&this.defaultLanguage!==this.fallbackLanguage&&this.translations[this.defaultLanguage]?.[t]?this.translations[this.defaultLanguage][t]:(console.warn(`[i18n] Translation key not found: "${t}" (lang: ${this.currentLanguage})`),e||t)}tLang(t,e,n){let s=this.currentLanguage;this.currentLanguage=e;let i=this.t(t,n);return this.currentLanguage=s,i}tParse(t,e){let n=this.t(t,e);n=n.replace(/\\n|\/n/g,"<br>");let s=[],i=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,r;for(;(r=i.exec(n))!==null;)r[4]?s.push({type:"text",content:r[4]}):r[1]?s.push({type:"tag",tag:r[1],content:r[2]}):r[3]&&s.push({type:"tag",tag:r[3],content:""});return s.length>0?s:[{type:"text",content:n}]}async setLanguage(t){if(!this.supportedLanguages.has(t)){console.warn(`[i18n] Language "${t}" not supported`);return}this.currentLanguage=t,this.storage&&await this.storage.set("i18n-language",t),this.listeners.forEach(e=>e(t)),this.onLanguageChange&&this.onLanguageChange(t);}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(t){return this.supportedLanguages.has(t)}hasKey(t){return !!(this.translations[this.currentLanguage]?.[t]||this.translations[this.fallbackLanguage]?.[t]||this.translations[this.defaultLanguage]?.[t])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(t){return this.rtlLanguages.has(t.toLowerCase().substring(0,2))}onChange(t){return this.listeners.add(t),()=>this.listeners.delete(t)}},h={get:a=>typeof localStorage>"u"?null:localStorage.getItem(a),set:(a,t)=>{typeof localStorage<"u"&&localStorage.setItem(a,t);}},L=(()=>{let a=new Map;return {get:t=>a.get(t)||null,set:(t,e)=>{a.set(t,e);}}})();async function f(a,t){let e=Array.isArray(a)?a:[a],n={};for(let s of e)try{let i=await fetch(s);if(i.ok){let r=await i.json(),c=s.match(/([a-z]{2,3})\.json$/i),d=c?c[1].toLowerCase():"en";n[d]=r;}}catch(i){console.warn(`[i18n] Failed to fetch: ${s}`,i);}Object.keys(n).length>0&&t.loadTranslations(n);}var l=class{constructor(t,e,n="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=t.endsWith("/")?t:t+"/",this.manager=e,this.fileExtension=n,this.isServerSide=typeof fetch>"u";}async load(t){if(this.loaded.has(t))return;if(this.loading.has(t))return this.loading.get(t);let e=this.doLoad(t);this.loading.set(t,e);try{await e,this.loaded.add(t);}finally{this.loading.delete(t);}}async doLoad(t){try{let e=`${this.baseUrl}${t}.${this.fileExtension}`,n;e.startsWith(".")||e.startsWith("/")||/^[a-zA-Z]:/.test(e)||this.isServerSide?n=await this.loadFromFile(e):n=await this.loadFromUrl(e),n&&this.manager.loadLanguage(t,n);}catch(e){console.warn(`[i18n] Error loading language: ${t}`,e);}}async loadFromUrl(t){try{let e=await fetch(t);return e.ok?await e.json():(console.warn(`[i18n] Failed to load language from URL: ${t} (${e.status})`),null)}catch(e){return console.warn(`[i18n] Error fetching from URL: ${t}`,e),null}}async loadFromFile(t){try{let e=await import('fs').then(r=>r.promises).catch(()=>null),n=await import('path').then(r=>r).catch(()=>null);if(!e)return console.warn("[i18n] fs module not available. Running in browser?"),null;let s=t;if(n&&!n.isAbsolute(t)){let r=await import('process').then(c=>c).catch(()=>null);r&&(s=n.resolve(r.cwd(),t));}let i=await e.readFile(s,"utf-8");return JSON.parse(i)}catch(e){return console.warn(`[i18n] Error reading file: ${t}`,e),null}}isLoaded(t){return this.loaded.has(t)}},g=null;function o(){return g||(g=new u),g}async function y(a){return g=new u(a),await g.init(),g}function b(a,t="json"){return new l(a,o(),t)}async function w(a){let t=new u(a);await t.init(),g=t;let e=a.basePath||a.baseUrl||"./locales/",n=a.fileExtension||"json",s=new l(e,t,n);return await s.load(t.getLanguage()),s}async function m(a){let t=new u(a);await t.init(),g=t;let e=a.fileExtension||"json",n=new l(a.basePath,t,e);return await n.load(t.getLanguage()),n}var p=(a,t)=>o().t(a,t),S=(a,t,e)=>o().tLang(a,t,e),T=(a,t)=>o().tParse(a,t),R=a=>o().setLanguage(a),P=()=>o().getLanguage(),I=()=>o().getSupportedLanguages(),$=a=>o().hasKey(a),v=()=>o().isRTL(),j=a=>o().isRTLLanguage(a),E=a=>o().onChange(a),z=(a,t)=>o().loadLanguage(a,t),M=a=>o().loadTranslations(a);function x(a,t="page."){let e=p("app.name"),n=p(t+a);return v()?`${e} - ${n}`:`${n} - ${e}`}function C(a,t,e){return p(a===1?t:e,{count:String(a)})}var O={I18nManager:u,getI18n:o,setupI18n:y,createLazyLoader:b,setupLazy:w,setupAuto:m,browserStorage:h,memoryStorage:L,fetchTranslations:f,genPageTitle:x,plural:C};exports.I18nManager=u;exports.LazyLoader=l;exports.browserStorage=h;exports.createLazyLoader=b;exports.default=O;exports.fetchTranslations=f;exports.genPageTitle=x;exports.getI18n=o;exports.getLanguage=P;exports.getSupportedLanguages=I;exports.hasKey=$;exports.isRTL=v;exports.isRTLLanguage=j;exports.loadLanguage=z;exports.loadTranslations=M;exports.memoryStorage=L;exports.onChange=E;exports.plural=C;exports.setLanguage=R;exports.setupAuto=m;exports.setupI18n=y;exports.setupLazy=w;exports.t=p;exports.tLang=S;exports.tParse=T;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map