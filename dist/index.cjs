'use strict';Object.defineProperty(exports,'__esModule',{value:true});var l=class{constructor(t){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;t&&(this.defaultLanguage=t.defaultLanguage||"en",this.currentLanguage=t.defaultLanguage||"en",this.storage=t.storage,this.onLanguageChange=t.onLanguageChange,t.supportedLanguages&&(this.supportedLanguages=new Set(t.supportedLanguages)));}async init(){if(this.storage){let t=await this.storage.get("lang");t&&this.supportedLanguages.has(t)&&(this.currentLanguage=t);}}loadLanguage(t,e){this.translations[t]||(this.translations[t]={});let a=this.flattenObject(e);this.translations[t]={...this.translations[t],...a},this.supportedLanguages.add(t);}loadTranslations(t){Object.entries(t).forEach(([e,a])=>{this.loadLanguage(e,a);});}flattenObject(t,e=""){let a={};for(let s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;let r=t[s],i=e?`${e}.${s}`:s;typeof r=="object"&&r!==null&&!Array.isArray(r)?Object.assign(a,this.flattenObject(r,i)):a[i]=String(r);}return a}t(t,e,a){let s=this.getTranslation(t,a);return e&&Object.entries(e).forEach(([r,i])=>{let g=this.getTranslation(i,i);s=s.replace(new RegExp(`\\{${r}\\}`,"g"),g);}),s}getTranslation(t,e){return this.translations[this.currentLanguage]?.[t]?this.translations[this.currentLanguage][t]:this.defaultLanguage!==this.currentLanguage&&this.translations[this.defaultLanguage]?.[t]?this.translations[this.defaultLanguage][t]:(console.warn(`[i18n] Translation key not found: "${t}" (lang: ${this.currentLanguage})`),e||t)}tLang(t,e,a,s){let r=this.currentLanguage;this.currentLanguage=t;let i=this.t(e,a,s);return this.currentLanguage=r,i}tParse(t,e,a){let s=this.t(t,e,a);s=s.replace(/\\n|\/n/g,"<br>");let r=[],i=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,g;for(;(g=i.exec(s))!==null;)g[4]?r.push({type:"text",content:g[4]}):g[1]?r.push({type:"tag",tag:g[1],content:g[2]}):g[3]&&r.push({type:"tag",tag:g[3],content:""});return r.length>0?r:[{type:"text",content:s}]}async setLanguage(t){this.supportedLanguages.has(t)&&(this.currentLanguage=t,this.storage&&await this.storage.set("lang",t),typeof document<"u"&&(h("lang",t,365),document.documentElement.lang=t),this.listeners.forEach(e=>e(t)),this.onLanguageChange&&this.onLanguageChange(t));}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(t){return this.supportedLanguages.has(t)}hasKey(t){return !!(this.translations[this.currentLanguage]?.[t]||this.translations[this.defaultLanguage]?.[t])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(t){return this.rtlLanguages.has(t.toLowerCase().substring(0,2))}onChange(t){return this.listeners.add(t),()=>this.listeners.delete(t)}};function h(n,t,e){let a="";{let s=new Date;s.setTime(s.getTime()+e*24*60*60*1e3),a="; expires="+s.toUTCString();}document.cookie=n+"="+(t||"")+a+"; path=/";}var L=()=>({get:n=>typeof localStorage>"u"?null:localStorage.getItem(n),set:(n,t)=>{typeof localStorage<"u"&&localStorage.setItem(n,t);}}),f=()=>{let n=new Map;return {get:t=>n.get(t)||null,set:(t,e)=>{n.set(t,e);}}},y=()=>typeof localStorage<"u"?L():f(),p=class{constructor(t,e,a="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=t.endsWith("/")?t:t+"/",this.manager=e,this.fileExtension=a,this.isServerSide=typeof fetch>"u";}async load(t){if(this.loaded.has(t))return;if(this.loading.has(t))return this.loading.get(t);let e=this.doLoad(t);this.loading.set(t,e);try{await e,this.loaded.add(t);}finally{this.loading.delete(t);}}async doLoad(t){try{let e=`${this.baseUrl}${t}.${this.fileExtension}`,a;e.startsWith(".")||e.startsWith("/")||/^[a-zA-Z]:/.test(e)||this.isServerSide?a=await this.loadFromFile(e):a=await this.loadFromUrl(e),a&&this.manager.loadLanguage(t,a);}catch(e){console.warn(`[i18n] Error loading language: ${t}`,e);}}async loadFromUrl(t){try{let e=await fetch(t);return e.ok?await e.json():(console.warn(`[i18n] Failed to load language from URL: ${t} (${e.status})`),null)}catch(e){return console.warn(`[i18n] Error fetching from URL: ${t}`,e),null}}async loadFromFile(t){try{let e=await import('fs').then(i=>i.promises).catch(()=>null),a=await import('path').then(i=>i).catch(()=>null);if(!e)return console.warn("[i18n] fs module not available. Running in browser?"),null;let s=t;if(a&&!a.isAbsolute(t)){let i=await import('process').then(g=>g).catch(()=>null);i&&(s=a.resolve(i.cwd(),t));}let r=await e.readFile(s,"utf-8");return JSON.parse(r)}catch(e){return console.warn(`[i18n] Error reading file: ${t}`,e),null}}isLoaded(t){return this.loaded.has(t)}},u=null,d=null;function m(){return typeof navigator<"u"&&navigator.language?navigator.language.split("-")[0].toLowerCase():"en"}function w(){return typeof fetch<"u"&&typeof window<"u"}function o(){return u||(u=new l),u}function v(){return d}async function b(n){if(w()&&!n.defaultLanguage){let t=m();n.supportedLanguages?.includes(t)?n.defaultLanguage=t:n.defaultLanguage=n.supportedLanguages?.[0]||"en";}if(n.storage||(n.storage=y()),u=new l(n),await u.init(),n.basePath){let t=n.fileExtension||"json";d=new p(n.basePath,u,t),await d.load(u.getLanguage());}return u}var c=(n,t,e)=>o().t(n,t,e),C=(n,t,e,a)=>o().tLang(n,t,e,a),x=(n,t,e)=>o().tParse(n,t,e),S=n=>d&&!d.isLoaded(n)?d.load(n).then(()=>o().setLanguage(n)):o().setLanguage(n),R=()=>o().getLanguage(),T=()=>o().getSupportedLanguages(),I=n=>o().hasKey(n),P=()=>o().isRTL(),E=n=>o().isRTLLanguage(n),$=n=>o().onChange(n),j=(n,t)=>o().loadLanguage(n,t),M=n=>o().loadTranslations(n);function O(n,t,e){return c(n===1?t:e,{count:String(n)})}var U={setupI18n:b,getI18n:o,getLazyLoader:v,I18nManager:l,LazyLoader:p,t:c,tLang:C,tParse:x,setLanguage:S,getLanguage:R,getSupportedLanguages:T,hasKey:I,isRTL:P,isRTLLanguage:E,onChange:$,loadLanguage:j,loadTranslations:M,plural:O};exports.I18nManager=l;exports.LazyLoader=p;exports.default=U;exports.getI18n=o;exports.getLanguage=R;exports.getLazyLoader=v;exports.getSupportedLanguages=T;exports.hasKey=I;exports.isRTL=P;exports.isRTLLanguage=E;exports.loadLanguage=j;exports.loadTranslations=M;exports.onChange=$;exports.plural=O;exports.setLanguage=S;exports.setupI18n=b;exports.t=c;exports.tLang=C;exports.tParse=x;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map