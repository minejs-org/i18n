'use strict';Object.defineProperty(exports,'__esModule',{value:true});var d=class{constructor(e){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;e&&(this.defaultLanguage=e.defaultLanguage||"en",this.currentLanguage=e.defaultLanguage||"en",this.storage=e.storage,this.onLanguageChange=e.onLanguageChange,e.supportedLanguages&&(this.supportedLanguages=new Set(e.supportedLanguages)));}async init(){if(this.storage){let e=await this.storage.get("i18n-language");e&&this.supportedLanguages.has(e)&&(this.currentLanguage=e);}}loadLanguage(e,t){this.translations[e]||(this.translations[e]={});let a=this.flattenObject(t);this.translations[e]={...this.translations[e],...a},this.supportedLanguages.add(e);}loadTranslations(e){Object.entries(e).forEach(([t,a])=>{this.loadLanguage(t,a);});}flattenObject(e,t=""){let a={};for(let r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;let s=e[r],i=t?`${t}.${r}`:r;typeof s=="object"&&s!==null&&!Array.isArray(s)?Object.assign(a,this.flattenObject(s,i)):a[i]=String(s);}return a}t(e,t,a){let r=this.getTranslation(e,a);return t&&Object.entries(t).forEach(([s,i])=>{let g=this.getTranslation(i,i);r=r.replace(new RegExp(`\\{${s}\\}`,"g"),g);}),r}getTranslation(e,t){return this.translations[this.currentLanguage]?.[e]?this.translations[this.currentLanguage][e]:this.defaultLanguage!==this.currentLanguage&&this.translations[this.defaultLanguage]?.[e]?this.translations[this.defaultLanguage][e]:(console.warn(`[i18n] Translation key not found: "${e}" (lang: ${this.currentLanguage})`),t||e)}tLang(e,t,a,r){let s=this.currentLanguage;this.currentLanguage=e;let i=this.t(t,a,r);return this.currentLanguage=s,i}tParse(e,t,a){let r=this.t(e,t,a);r=r.replace(/\\n|\/n/g,"<br>");let s=[],i=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,g;for(;(g=i.exec(r))!==null;)g[4]?s.push({type:"text",content:g[4]}):g[1]?s.push({type:"tag",tag:g[1],content:g[2]}):g[3]&&s.push({type:"tag",tag:g[3],content:""});return s.length>0?s:[{type:"text",content:r}]}async setLanguage(e,t=true,a=true,r=true){if(!this.supportedLanguages.has(e)){console.warn(`[i18n] Language "${e}" not supported, aborting setLanguage()`);return}this.currentLanguage=e,this.storage&&await this.storage.set("i18n-language",e),typeof document<"u"&&(r&&h("lang",e,365),t&&(document.documentElement.lang=e),a&&(document.documentElement.dir=this.isRTL()?"rtl":"ltr")),this.listeners.forEach(s=>s(e)),this.onLanguageChange&&this.onLanguageChange(e);}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(e){return this.supportedLanguages.has(e)}hasKey(e){return !!(this.translations[this.currentLanguage]?.[e]||this.translations[this.defaultLanguage]?.[e])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(e){return this.rtlLanguages.has(e.toLowerCase().substring(0,2))}onChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}};function h(n,e,t){let a="";{let r=new Date;r.setTime(r.getTime()+t*24*60*60*1e3),a="; expires="+r.toUTCString();}document.cookie=n+"="+(e||"")+a+"; path=/";}var f=()=>({get:n=>typeof localStorage>"u"?null:localStorage.getItem(n),set:(n,e)=>{typeof localStorage<"u"&&localStorage.setItem(n,e);}}),y=()=>{let n=new Map;return {get:e=>n.get(e)||null,set:(e,t)=>{n.set(e,t);}}},m=()=>typeof localStorage<"u"?f():y(),p=class{constructor(e,t,a="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=e.endsWith("/")?e:e+"/",this.manager=t,this.fileExtension=a,this.isServerSide=typeof fetch>"u";}async load(e){if(this.loaded.has(e))return;if(this.loading.has(e))return this.loading.get(e);let t=this.doLoad(e);this.loading.set(e,t);try{await t,this.loaded.add(e);}catch(a){console.error(`[LazyLoader] Error loading language "${e}":`,a);}finally{this.loading.delete(e);}}async doLoad(e){try{let t=`${this.baseUrl}${e}.${this.fileExtension}`,a;t.startsWith(".")||t.startsWith("/")||/^[a-zA-Z]:/.test(t)||this.isServerSide?a=await this.loadFromFile(t):a=await this.loadFromUrl(t),a?this.manager.loadLanguage(e,a):console.warn(`[LazyLoader] No data loaded for language: "${e}"`);}catch(t){console.warn(`[i18n] Error loading language: ${e}`,t);}}async loadFromUrl(e){try{let t=await fetch(e);return t.ok?await t.json():(console.warn(`[i18n] Failed to load language from URL: ${e} (${t.status})`),null)}catch(t){return console.warn(`[i18n] Error fetching from URL: ${e}`,t),null}}async loadFromFile(e){try{let t=await import('fs').then(i=>i.promises).catch(()=>null),a=await import('path').then(i=>i).catch(()=>null);if(!t)return console.warn("[i18n] fs module not available. Running in browser?"),null;let r=e;if(a&&!a.isAbsolute(e)){let i=await import('process').then(g=>g).catch(()=>null);i&&(r=a.resolve(i.cwd(),e));}let s=await t.readFile(r,"utf-8");return JSON.parse(s)}catch(t){return console.warn(`[i18n] Error reading file: ${e}`,t),null}}isLoaded(e){return this.loaded.has(e)}},u=null,l=null;function w(){return typeof navigator<"u"&&navigator.language?navigator.language.split("-")[0].toLowerCase():"en"}function c(){return typeof fetch<"u"&&typeof window<"u"}function o(){return u||(u=new d),u}function v(){return l}async function b(n){if(c()&&!n.defaultLanguage){let e=w();n.supportedLanguages?.includes(e)?n.defaultLanguage=e:n.defaultLanguage=n.supportedLanguages?.[0]||"en";}if(n.storage||(n.storage=m()),u=new d(n),await u.init(),n.basePath){let e=n.fileExtension||"json";l=new p(n.basePath,u,e),await l.load(u.getLanguage());}return c()&&(document.documentElement.lang=u.getLanguage(),document.documentElement.dir=u.isRTL()?"rtl":"ltr"),u}var L=(n,e,t)=>o().t(n,e,t),C=(n,e,t,a)=>o().tLang(n,e,t,a),A=async(n,e,t,a)=>(l&&!l.isLoaded(n)&&await l.load(n),o().tLang(n,e,t,a)),x=(n,e,t)=>o().tParse(n,e,t),S=(n,e=true,t=true,a=true)=>l&&!l.isLoaded(n)?l.load(n).then(()=>o().setLanguage(n,e,t,a)):o().setLanguage(n,e,t,a),R=()=>o().getLanguage(),T=()=>o().getSupportedLanguages(),I=n=>o().hasKey(n),P=()=>o().isRTL(),E=n=>o().isRTLLanguage(n),$=n=>o().onChange(n),j=(n,e)=>o().loadLanguage(n,e),z=n=>o().loadTranslations(n);function M(n,e,t){return L(n===1?e:t,{count:String(n)})}var U={setupI18n:b,getI18n:o,getLazyLoader:v,I18nManager:d,LazyLoader:p,t:L,tLang:C,tParse:x,setLanguage:S,getLanguage:R,getSupportedLanguages:T,hasKey:I,isRTL:P,isRTLLanguage:E,onChange:$,loadLanguage:j,loadTranslations:z,plural:M};exports.I18nManager=d;exports.LazyLoader=p;exports.default=U;exports.getI18n=o;exports.getLanguage=R;exports.getLazyLoader=v;exports.getSupportedLanguages=T;exports.hasKey=I;exports.isRTL=P;exports.isRTLLanguage=E;exports.loadLanguage=j;exports.loadTranslations=z;exports.onChange=$;exports.plural=M;exports.setLanguage=S;exports.setupI18n=b;exports.t=L;exports.tLang=C;exports.tLangAsync=A;exports.tParse=x;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map