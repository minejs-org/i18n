'use strict';Object.defineProperty(exports,'__esModule',{value:true});var u=class{constructor(e){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;e&&(this.defaultLanguage=e.defaultLanguage||"en",this.currentLanguage=e.defaultLanguage||"en",this.storage=e.storage,this.onLanguageChange=e.onLanguageChange,e.supportedLanguages&&(this.supportedLanguages=new Set(e.supportedLanguages)));}async init(){if(this.storage){let e=await this.storage.get("i18n-language");e&&this.supportedLanguages.has(e)&&(this.currentLanguage=e);}}loadLanguage(e,t){this.translations[e]||(this.translations[e]={});let a=this.flattenObject(t);this.translations[e]={...this.translations[e],...a},this.supportedLanguages.add(e);}loadTranslations(e){Object.entries(e).forEach(([t,a])=>{this.loadLanguage(t,a);});}flattenObject(e,t=""){let a={};for(let r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;let i=e[r],s=t?`${t}.${r}`:r;typeof i=="object"&&i!==null&&!Array.isArray(i)?Object.assign(a,this.flattenObject(i,s)):a[s]=String(i);}return a}t(e,t){let a=this.getTranslation(e);return t&&Object.entries(t).forEach(([r,i])=>{let s=this.getTranslation(i,i);a=a.replace(new RegExp(`\\{${r}\\}`,"g"),s);}),a}getTranslation(e,t){return this.translations[this.currentLanguage]?.[e]?this.translations[this.currentLanguage][e]:this.defaultLanguage!==this.currentLanguage&&this.translations[this.defaultLanguage]?.[e]?this.translations[this.defaultLanguage][e]:(console.warn(`[i18n] Translation key not found: "${e}" (lang: ${this.currentLanguage})`),t||e)}tLang(e,t,a){let r=this.currentLanguage;this.currentLanguage=t;let i=this.t(e,a);return this.currentLanguage=r,i}tParse(e,t){let a=this.t(e,t);a=a.replace(/\\n|\/n/g,"<br>");let r=[],i=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,s;for(;(s=i.exec(a))!==null;)s[4]?r.push({type:"text",content:s[4]}):s[1]?r.push({type:"tag",tag:s[1],content:s[2]}):s[3]&&r.push({type:"tag",tag:s[3],content:""});return r.length>0?r:[{type:"text",content:a}]}async setLanguage(e){if(!this.supportedLanguages.has(e)){console.warn(`[i18n] Language "${e}" not supported`);return}this.currentLanguage=e,this.storage&&await this.storage.set("i18n-language",e),this.listeners.forEach(t=>t(e)),this.onLanguageChange&&this.onLanguageChange(e);}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(e){return this.supportedLanguages.has(e)}hasKey(e){return !!(this.translations[this.currentLanguage]?.[e]||this.translations[this.defaultLanguage]?.[e])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(e){return this.rtlLanguages.has(e.toLowerCase().substring(0,2))}onChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}};var L=()=>({get:n=>typeof localStorage>"u"?null:localStorage.getItem(n),set:(n,e)=>{typeof localStorage<"u"&&localStorage.setItem(n,e);}}),y=()=>{let n=new Map;return {get:e=>n.get(e)||null,set:(e,t)=>{n.set(e,t);}}},f=()=>typeof localStorage<"u"?L():y(),p=class{constructor(e,t,a="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=e.endsWith("/")?e:e+"/",this.manager=t,this.fileExtension=a,this.isServerSide=typeof fetch>"u";}async load(e){if(this.loaded.has(e))return;if(this.loading.has(e))return this.loading.get(e);let t=this.doLoad(e);this.loading.set(e,t);try{await t,this.loaded.add(e);}finally{this.loading.delete(e);}}async doLoad(e){try{let t=`${this.baseUrl}${e}.${this.fileExtension}`,a;t.startsWith(".")||t.startsWith("/")||/^[a-zA-Z]:/.test(t)||this.isServerSide?a=await this.loadFromFile(t):a=await this.loadFromUrl(t),a&&this.manager.loadLanguage(e,a);}catch(t){console.warn(`[i18n] Error loading language: ${e}`,t);}}async loadFromUrl(e){try{let t=await fetch(e);return t.ok?await t.json():(console.warn(`[i18n] Failed to load language from URL: ${e} (${t.status})`),null)}catch(t){return console.warn(`[i18n] Error fetching from URL: ${e}`,t),null}}async loadFromFile(e){try{let t=await import('fs').then(s=>s.promises).catch(()=>null),a=await import('path').then(s=>s).catch(()=>null);if(!t)return console.warn("[i18n] fs module not available. Running in browser?"),null;let r=e;if(a&&!a.isAbsolute(e)){let s=await import('process').then(h=>h).catch(()=>null);s&&(r=a.resolve(s.cwd(),e));}let i=await t.readFile(r,"utf-8");return JSON.parse(i)}catch(t){return console.warn(`[i18n] Error reading file: ${e}`,t),null}}isLoaded(e){return this.loaded.has(e)}},g=null,l=null;function w(){return typeof navigator<"u"&&navigator.language?navigator.language.split("-")[0].toLowerCase():"en"}function m(){return typeof fetch<"u"&&typeof window<"u"}function o(){return g||(g=new u),g}function v(){return l}async function b(n){if(m()&&!n.defaultLanguage){let e=w();n.supportedLanguages?.includes(e)?n.defaultLanguage=e:n.defaultLanguage=n.supportedLanguages?.[0]||"en";}if(n.storage||(n.storage=f()),g=new u(n),await g.init(),n.basePath){let e=n.fileExtension||"json";l=new p(n.basePath,g,e),await l.load(g.getLanguage());}return g}var d=(n,e)=>o().t(n,e),C=(n,e,t)=>o().tLang(n,e,t),x=(n,e)=>o().tParse(n,e),S=n=>l&&!l.isLoaded(n)?l.load(n).then(()=>o().setLanguage(n)):o().setLanguage(n),R=()=>o().getLanguage(),T=()=>o().getSupportedLanguages(),I=n=>o().hasKey(n),c=()=>o().isRTL(),P=n=>o().isRTLLanguage(n),$=n=>o().onChange(n),E=(n,e)=>o().loadLanguage(n,e),j=n=>o().loadTranslations(n);function M(n,e="page."){let t=d("app.name"),a=d(e+n);return c()?`${t} - ${a}`:`${a} - ${t}`}function O(n,e,t){return d(n===1?e:t,{count:String(n)})}var A={setupI18n:b,getI18n:o,getLazyLoader:v,I18nManager:u,LazyLoader:p,t:d,tLang:C,tParse:x,setLanguage:S,getLanguage:R,getSupportedLanguages:T,hasKey:I,isRTL:c,isRTLLanguage:P,onChange:$,loadLanguage:E,loadTranslations:j,genPageTitle:M,plural:O};exports.I18nManager=u;exports.LazyLoader=p;exports.default=A;exports.genPageTitle=M;exports.getI18n=o;exports.getLanguage=R;exports.getLazyLoader=v;exports.getSupportedLanguages=T;exports.hasKey=I;exports.isRTL=c;exports.isRTLLanguage=P;exports.loadLanguage=E;exports.loadTranslations=j;exports.onChange=$;exports.plural=O;exports.setLanguage=S;exports.setupI18n=b;exports.t=d;exports.tLang=C;exports.tParse=x;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map