var d=class{constructor(e){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;e&&(this.defaultLanguage=e.defaultLanguage||"en",this.currentLanguage=e.defaultLanguage||"en",this.storage=e.storage,this.onLanguageChange=e.onLanguageChange,e.supportedLanguages&&(this.supportedLanguages=new Set(e.supportedLanguages)));}async init(){if(this.storage){let e=await this.storage.get("i18n-language");e&&this.supportedLanguages.has(e)&&(this.currentLanguage=e);}}loadLanguage(e,t){this.translations[e]||(this.translations[e]={});let a=this.flattenObject(t);this.translations[e]={...this.translations[e],...a},this.supportedLanguages.add(e);}loadTranslations(e){Object.entries(e).forEach(([t,a])=>{this.loadLanguage(t,a);});}flattenObject(e,t=""){let a={};for(let s in e){if(!Object.prototype.hasOwnProperty.call(e,s))continue;let r=e[s],i=t?`${t}.${s}`:s;typeof r=="object"&&r!==null&&!Array.isArray(r)?Object.assign(a,this.flattenObject(r,i)):a[i]=String(r);}return a}t(e,t,a){let s=this.getTranslation(e,a);return t&&Object.entries(t).forEach(([r,i])=>{let g=this.getTranslation(i,i);s=s.replace(new RegExp(`\\{${r}\\}`,"g"),g);}),s}getTranslation(e,t){return this.translations[this.currentLanguage]?.[e]?this.translations[this.currentLanguage][e]:this.defaultLanguage!==this.currentLanguage&&this.translations[this.defaultLanguage]?.[e]?this.translations[this.defaultLanguage][e]:(console.warn(`[i18n] Translation key not found: "${e}" (lang: ${this.currentLanguage})`),t||e)}tLang(e,t,a,s){let r=this.currentLanguage;this.currentLanguage=e;let i=this.t(t,a,s);return this.currentLanguage=r,i}tParse(e,t,a){let s=this.t(e,t,a);s=s.replace(/\\n|\/n/g,"<br>");let r=[],i=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,g;for(;(g=i.exec(s))!==null;)g[4]?r.push({type:"text",content:g[4]}):g[1]?r.push({type:"tag",tag:g[1],content:g[2]}):g[3]&&r.push({type:"tag",tag:g[3],content:""});return r.length>0?r:[{type:"text",content:s}]}async setLanguage(e){if(!this.supportedLanguages.has(e)){console.warn(`[i18n] Language "${e}" not supported, aborting setLanguage()`);return}this.currentLanguage=e,this.storage&&await this.storage.set("i18n-language",e),typeof document<"u"&&(L("lang",e,365),document.documentElement.lang=e),this.listeners.forEach(t=>t(e)),this.onLanguageChange&&this.onLanguageChange(e);}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(e){return this.supportedLanguages.has(e)}hasKey(e){return !!(this.translations[this.currentLanguage]?.[e]||this.translations[this.defaultLanguage]?.[e])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(e){return this.rtlLanguages.has(e.toLowerCase().substring(0,2))}onChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}};function L(n,e,t){let a="";{let s=new Date;s.setTime(s.getTime()+t*24*60*60*1e3),a="; expires="+s.toUTCString();}document.cookie=n+"="+(e||"")+a+"; path=/";}var h=()=>({get:n=>typeof localStorage>"u"?null:localStorage.getItem(n),set:(n,e)=>{typeof localStorage<"u"&&localStorage.setItem(n,e);}}),f=()=>{let n=new Map;return {get:e=>n.get(e)||null,set:(e,t)=>{n.set(e,t);}}},y=()=>typeof localStorage<"u"?h():f(),p=class{constructor(e,t,a="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=e.endsWith("/")?e:e+"/",this.manager=t,this.fileExtension=a,this.isServerSide=typeof fetch>"u";}async load(e){if(this.loaded.has(e))return;if(this.loading.has(e))return this.loading.get(e);let t=this.doLoad(e);this.loading.set(e,t);try{await t,this.loaded.add(e);}catch(a){console.error(`[LazyLoader] Error loading language "${e}":`,a);}finally{this.loading.delete(e);}}async doLoad(e){try{let t=`${this.baseUrl}${e}.${this.fileExtension}`,a;t.startsWith(".")||t.startsWith("/")||/^[a-zA-Z]:/.test(t)||this.isServerSide?a=await this.loadFromFile(t):a=await this.loadFromUrl(t),a?this.manager.loadLanguage(e,a):console.warn(`[LazyLoader] No data loaded for language: "${e}"`);}catch(t){console.warn(`[i18n] Error loading language: ${e}`,t);}}async loadFromUrl(e){try{let t=await fetch(e);return t.ok?await t.json():(console.warn(`[i18n] Failed to load language from URL: ${e} (${t.status})`),null)}catch(t){return console.warn(`[i18n] Error fetching from URL: ${e}`,t),null}}async loadFromFile(e){try{let t=await import('fs').then(i=>i.promises).catch(()=>null),a=await import('path').then(i=>i).catch(()=>null);if(!t)return console.warn("[i18n] fs module not available. Running in browser?"),null;let s=e;if(a&&!a.isAbsolute(e)){let i=await import('process').then(g=>g).catch(()=>null);i&&(s=a.resolve(i.cwd(),e));}let r=await t.readFile(s,"utf-8");return JSON.parse(r)}catch(t){return console.warn(`[i18n] Error reading file: ${e}`,t),null}}isLoaded(e){return this.loaded.has(e)}},l=null,u=null;function w(){return typeof navigator<"u"&&navigator.language?navigator.language.split("-")[0].toLowerCase():"en"}function m(){return typeof fetch<"u"&&typeof window<"u"}function o(){return l||(l=new d),l}function v(){return u}async function b(n){if(m()&&!n.defaultLanguage){let e=w();n.supportedLanguages?.includes(e)?n.defaultLanguage=e:n.defaultLanguage=n.supportedLanguages?.[0]||"en";}if(n.storage||(n.storage=y()),l=new d(n),await l.init(),n.basePath){let e=n.fileExtension||"json";u=new p(n.basePath,l,e),await u.load(l.getLanguage());}return l}var c=(n,e,t)=>o().t(n,e,t),C=(n,e,t,a)=>o().tLang(n,e,t,a),A=async(n,e,t,a)=>(u&&!u.isLoaded(n)&&await u.load(n),o().tLang(n,e,t,a)),x=(n,e,t)=>o().tParse(n,e,t),S=n=>u&&!u.isLoaded(n)?u.load(n).then(()=>o().setLanguage(n)):o().setLanguage(n),R=()=>o().getLanguage(),T=()=>o().getSupportedLanguages(),I=n=>o().hasKey(n),P=()=>o().isRTL(),$=n=>o().isRTLLanguage(n),E=n=>o().onChange(n),j=(n,e)=>o().loadLanguage(n,e),z=n=>o().loadTranslations(n);function M(n,e,t){return c(n===1?e:t,{count:String(n)})}var U={setupI18n:b,getI18n:o,getLazyLoader:v,I18nManager:d,LazyLoader:p,t:c,tLang:C,tParse:x,setLanguage:S,getLanguage:R,getSupportedLanguages:T,hasKey:I,isRTL:P,isRTLLanguage:$,onChange:E,loadLanguage:j,loadTranslations:z,plural:M};export{d as I18nManager,p as LazyLoader,U as default,o as getI18n,R as getLanguage,v as getLazyLoader,T as getSupportedLanguages,I as hasKey,P as isRTL,$ as isRTLLanguage,j as loadLanguage,z as loadTranslations,E as onChange,M as plural,S as setLanguage,b as setupI18n,c as t,C as tLang,A as tLangAsync,x as tParse};//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map