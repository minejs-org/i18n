var u=class{constructor(t){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;t&&(this.defaultLanguage=t.defaultLanguage||"en",this.currentLanguage=t.defaultLanguage||"en",this.storage=t.storage,this.onLanguageChange=t.onLanguageChange,t.supportedLanguages&&(this.supportedLanguages=new Set(t.supportedLanguages)));}async init(){if(this.storage){let t=await this.storage.get("lang");t&&this.supportedLanguages.has(t)&&(this.currentLanguage=t);}}loadLanguage(t,e){this.translations[t]||(this.translations[t]={});let a=this.flattenObject(e);this.translations[t]={...this.translations[t],...a},this.supportedLanguages.add(t);}loadTranslations(t){Object.entries(t).forEach(([e,a])=>{this.loadLanguage(e,a);});}flattenObject(t,e=""){let a={};for(let s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;let i=t[s],r=e?`${e}.${s}`:s;typeof i=="object"&&i!==null&&!Array.isArray(i)?Object.assign(a,this.flattenObject(i,r)):a[r]=String(i);}return a}t(t,e){let a=this.getTranslation(t);return e&&Object.entries(e).forEach(([s,i])=>{let r=this.getTranslation(i,i);a=a.replace(new RegExp(`\\{${s}\\}`,"g"),r);}),a}getTranslation(t,e){return this.translations[this.currentLanguage]?.[t]?this.translations[this.currentLanguage][t]:this.defaultLanguage!==this.currentLanguage&&this.translations[this.defaultLanguage]?.[t]?this.translations[this.defaultLanguage][t]:(console.warn(`[i18n] Translation key not found: "${t}" (lang: ${this.currentLanguage})`),e||t)}tLang(t,e,a){let s=this.currentLanguage;this.currentLanguage=e;let i=this.t(t,a);return this.currentLanguage=s,i}tParse(t,e){let a=this.t(t,e);a=a.replace(/\\n|\/n/g,"<br>");let s=[],i=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,r;for(;(r=i.exec(a))!==null;)r[4]?s.push({type:"text",content:r[4]}):r[1]?s.push({type:"tag",tag:r[1],content:r[2]}):r[3]&&s.push({type:"tag",tag:r[3],content:""});return s.length>0?s:[{type:"text",content:a}]}async setLanguage(t){this.supportedLanguages.has(t)&&(this.currentLanguage=t,this.storage&&await this.storage.set("lang",t),h("lang",t,365),this.listeners.forEach(e=>e(t)),this.onLanguageChange&&this.onLanguageChange(t));}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(t){return this.supportedLanguages.has(t)}hasKey(t){return !!(this.translations[this.currentLanguage]?.[t]||this.translations[this.defaultLanguage]?.[t])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(t){return this.rtlLanguages.has(t.toLowerCase().substring(0,2))}onChange(t){return this.listeners.add(t),()=>this.listeners.delete(t)}};function h(n,t,e){let a="";{let s=new Date;s.setTime(s.getTime()+e*24*60*60*1e3),a="; expires="+s.toUTCString();}document.cookie=n+"="+(t||"")+a+"; path=/";}var L=()=>({get:n=>typeof localStorage>"u"?null:localStorage.getItem(n),set:(n,t)=>{typeof localStorage<"u"&&localStorage.setItem(n,t);}}),f=()=>{let n=new Map;return {get:t=>n.get(t)||null,set:(t,e)=>{n.set(t,e);}}},y=()=>typeof localStorage<"u"?L():f(),p=class{constructor(t,e,a="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=t.endsWith("/")?t:t+"/",this.manager=e,this.fileExtension=a,this.isServerSide=typeof fetch>"u";}async load(t){if(this.loaded.has(t))return;if(this.loading.has(t))return this.loading.get(t);let e=this.doLoad(t);this.loading.set(t,e);try{await e,this.loaded.add(t);}finally{this.loading.delete(t);}}async doLoad(t){try{let e=`${this.baseUrl}${t}.${this.fileExtension}`,a;e.startsWith(".")||e.startsWith("/")||/^[a-zA-Z]:/.test(e)||this.isServerSide?a=await this.loadFromFile(e):a=await this.loadFromUrl(e),a&&this.manager.loadLanguage(t,a);}catch(e){console.warn(`[i18n] Error loading language: ${t}`,e);}}async loadFromUrl(t){try{let e=await fetch(t);return e.ok?await e.json():(console.warn(`[i18n] Failed to load language from URL: ${t} (${e.status})`),null)}catch(e){return console.warn(`[i18n] Error fetching from URL: ${t}`,e),null}}async loadFromFile(t){try{let e=await import('fs').then(r=>r.promises).catch(()=>null),a=await import('path').then(r=>r).catch(()=>null);if(!e)return console.warn("[i18n] fs module not available. Running in browser?"),null;let s=t;if(a&&!a.isAbsolute(t)){let r=await import('process').then(c=>c).catch(()=>null);r&&(s=a.resolve(r.cwd(),t));}let i=await e.readFile(s,"utf-8");return JSON.parse(i)}catch(e){return console.warn(`[i18n] Error reading file: ${t}`,e),null}}isLoaded(t){return this.loaded.has(t)}},g=null,l=null;function w(){return typeof navigator<"u"&&navigator.language?navigator.language.split("-")[0].toLowerCase():"en"}function m(){return typeof fetch<"u"&&typeof window<"u"}function o(){return g||(g=new u),g}function v(){return l}async function b(n){if(m()&&!n.defaultLanguage){let t=w();n.supportedLanguages?.includes(t)?n.defaultLanguage=t:n.defaultLanguage=n.supportedLanguages?.[0]||"en";}if(n.storage||(n.storage=y()),g=new u(n),await g.init(),n.basePath){let t=n.fileExtension||"json";l=new p(n.basePath,g,t),await l.load(g.getLanguage());}return g}var d=(n,t)=>o().t(n,t),C=(n,t,e)=>o().tLang(n,t,e),x=(n,t)=>o().tParse(n,t),S=n=>l&&!l.isLoaded(n)?l.load(n).then(()=>o().setLanguage(n)):o().setLanguage(n),R=()=>o().getLanguage(),T=()=>o().getSupportedLanguages(),I=n=>o().hasKey(n),P=()=>o().isRTL(),$=n=>o().isRTLLanguage(n),E=n=>o().onChange(n),j=(n,t)=>o().loadLanguage(n,t),M=n=>o().loadTranslations(n);function O(n,t,e){return d(n===1?t:e,{count:String(n)})}var U={setupI18n:b,getI18n:o,getLazyLoader:v,I18nManager:u,LazyLoader:p,t:d,tLang:C,tParse:x,setLanguage:S,getLanguage:R,getSupportedLanguages:T,hasKey:I,isRTL:P,isRTLLanguage:$,onChange:E,loadLanguage:j,loadTranslations:M,plural:O};export{u as I18nManager,p as LazyLoader,U as default,o as getI18n,R as getLanguage,v as getLazyLoader,T as getSupportedLanguages,I as hasKey,P as isRTL,$ as isRTLLanguage,j as loadLanguage,M as loadTranslations,E as onChange,O as plural,S as setLanguage,b as setupI18n,d as t,C as tLang,x as tParse};//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map