var u=class{constructor(e){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;e&&(this.defaultLanguage=e.defaultLanguage||"en",this.currentLanguage=e.defaultLanguage||"en",this.storage=e.storage,this.onLanguageChange=e.onLanguageChange,e.supportedLanguages&&(this.supportedLanguages=new Set(e.supportedLanguages)));}async init(){if(this.storage){let e=await this.storage.get("lang");e&&this.supportedLanguages.has(e)&&(this.currentLanguage=e);}}loadLanguage(e,t){this.translations[e]||(this.translations[e]={});let a=this.flattenObject(t);this.translations[e]={...this.translations[e],...a},this.supportedLanguages.add(e);}loadTranslations(e){Object.entries(e).forEach(([t,a])=>{this.loadLanguage(t,a);});}flattenObject(e,t=""){let a={};for(let s in e){if(!Object.prototype.hasOwnProperty.call(e,s))continue;let i=e[s],r=t?`${t}.${s}`:s;typeof i=="object"&&i!==null&&!Array.isArray(i)?Object.assign(a,this.flattenObject(i,r)):a[r]=String(i);}return a}t(e,t){let a=this.getTranslation(e);return t&&Object.entries(t).forEach(([s,i])=>{let r=this.getTranslation(i,i);a=a.replace(new RegExp(`\\{${s}\\}`,"g"),r);}),a}getTranslation(e,t){return this.translations[this.currentLanguage]?.[e]?this.translations[this.currentLanguage][e]:this.defaultLanguage!==this.currentLanguage&&this.translations[this.defaultLanguage]?.[e]?this.translations[this.defaultLanguage][e]:(console.warn(`[i18n] Translation key not found: "${e}" (lang: ${this.currentLanguage})`),t||e)}tLang(e,t,a){let s=this.currentLanguage;this.currentLanguage=t;let i=this.t(e,a);return this.currentLanguage=s,i}tParse(e,t){let a=this.t(e,t);a=a.replace(/\\n|\/n/g,"<br>");let s=[],i=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,r;for(;(r=i.exec(a))!==null;)r[4]?s.push({type:"text",content:r[4]}):r[1]?s.push({type:"tag",tag:r[1],content:r[2]}):r[3]&&s.push({type:"tag",tag:r[3],content:""});return s.length>0?s:[{type:"text",content:a}]}async setLanguage(e){this.supportedLanguages.has(e)&&(this.currentLanguage=e,this.storage&&await this.storage.set("lang",e),typeof document<"u"&&(h("lang",e,365),document.documentElement.lang=e),this.listeners.forEach(t=>t(e)),this.onLanguageChange&&this.onLanguageChange(e));}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(e){return this.supportedLanguages.has(e)}hasKey(e){return !!(this.translations[this.currentLanguage]?.[e]||this.translations[this.defaultLanguage]?.[e])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(e){return this.rtlLanguages.has(e.toLowerCase().substring(0,2))}onChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}};function h(n,e,t){let a="";{let s=new Date;s.setTime(s.getTime()+t*24*60*60*1e3),a="; expires="+s.toUTCString();}document.cookie=n+"="+(e||"")+a+"; path=/";}var L=()=>({get:n=>typeof localStorage>"u"?null:localStorage.getItem(n),set:(n,e)=>{typeof localStorage<"u"&&localStorage.setItem(n,e);}}),f=()=>{let n=new Map;return {get:e=>n.get(e)||null,set:(e,t)=>{n.set(e,t);}}},y=()=>typeof localStorage<"u"?L():f(),d=class{constructor(e,t,a="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=e.endsWith("/")?e:e+"/",this.manager=t,this.fileExtension=a,this.isServerSide=typeof fetch>"u";}async load(e){if(this.loaded.has(e))return;if(this.loading.has(e))return this.loading.get(e);let t=this.doLoad(e);this.loading.set(e,t);try{await t,this.loaded.add(e);}finally{this.loading.delete(e);}}async doLoad(e){try{let t=`${this.baseUrl}${e}.${this.fileExtension}`,a;t.startsWith(".")||t.startsWith("/")||/^[a-zA-Z]:/.test(t)||this.isServerSide?a=await this.loadFromFile(t):a=await this.loadFromUrl(t),a&&this.manager.loadLanguage(e,a);}catch(t){console.warn(`[i18n] Error loading language: ${e}`,t);}}async loadFromUrl(e){try{let t=await fetch(e);return t.ok?await t.json():(console.warn(`[i18n] Failed to load language from URL: ${e} (${t.status})`),null)}catch(t){return console.warn(`[i18n] Error fetching from URL: ${e}`,t),null}}async loadFromFile(e){try{let t=await import('fs').then(r=>r.promises).catch(()=>null),a=await import('path').then(r=>r).catch(()=>null);if(!t)return console.warn("[i18n] fs module not available. Running in browser?"),null;let s=e;if(a&&!a.isAbsolute(e)){let r=await import('process').then(c=>c).catch(()=>null);r&&(s=a.resolve(r.cwd(),e));}let i=await t.readFile(s,"utf-8");return JSON.parse(i)}catch(t){return console.warn(`[i18n] Error reading file: ${e}`,t),null}}isLoaded(e){return this.loaded.has(e)}},g=null,l=null;function m(){return typeof navigator<"u"&&navigator.language?navigator.language.split("-")[0].toLowerCase():"en"}function w(){return typeof fetch<"u"&&typeof window<"u"}function o(){return g||(g=new u),g}function v(){return l}async function b(n){if(w()&&!n.defaultLanguage){let e=m();n.supportedLanguages?.includes(e)?n.defaultLanguage=e:n.defaultLanguage=n.supportedLanguages?.[0]||"en";}if(n.storage||(n.storage=y()),g=new u(n),await g.init(),n.basePath){let e=n.fileExtension||"json";l=new d(n.basePath,g,e),await l.load(g.getLanguage());}return g}var p=(n,e)=>o().t(n,e),C=(n,e,t)=>o().tLang(n,e,t),x=(n,e)=>o().tParse(n,e),S=n=>l&&!l.isLoaded(n)?l.load(n).then(()=>o().setLanguage(n)):o().setLanguage(n),R=()=>o().getLanguage(),T=()=>o().getSupportedLanguages(),I=n=>o().hasKey(n),P=()=>o().isRTL(),E=n=>o().isRTLLanguage(n),$=n=>o().onChange(n),j=(n,e)=>o().loadLanguage(n,e),M=n=>o().loadTranslations(n);function O(n,e,t){return p(n===1?e:t,{count:String(n)})}var U={setupI18n:b,getI18n:o,getLazyLoader:v,I18nManager:u,LazyLoader:d,t:p,tLang:C,tParse:x,setLanguage:S,getLanguage:R,getSupportedLanguages:T,hasKey:I,isRTL:P,isRTLLanguage:E,onChange:$,loadLanguage:j,loadTranslations:M,plural:O};export{u as I18nManager,d as LazyLoader,U as default,o as getI18n,R as getLanguage,v as getLazyLoader,T as getSupportedLanguages,I as hasKey,P as isRTL,E as isRTLLanguage,j as loadLanguage,M as loadTranslations,$ as onChange,O as plural,S as setLanguage,b as setupI18n,p as t,C as tLang,x as tParse};//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map