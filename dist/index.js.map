{"version":3,"sources":["../src/mod/i18n.ts","../src/index.ts"],"names":["I18nManager","config","stored","lang","translations","flattened","trans","obj","prefix","key","value","newKey","params","fallback","translation","param","paramValue","original","result","tokens","regex","match","_setLang","_setDir","_setCookie","setCookie","fn","callback","name","days","expires","date","createBrowserStorage","createMemoryStorage","store","getDefaultStorage","LazyLoader","baseUrl","manager","fileExtension","promise","error","filePath","data","url","response","fs","m","path","resolvedPath","process","content","instance","lazyLoader","detectBrowserLanguage","isBrowser","getI18n","getLazyLoader","setupI18n","detectedLang","t","tLang","tLangAsync","tParse","setLanguage","getLanguage","getSupportedLanguages","hasKey","isRTL","isRTLLanguage","onChange","loadLanguage","loadTranslations","plural","count","singleKey","pluralKey","index_default"],"mappings":"AAgBW,IAAMA,EAAN,KAAkB,CAajB,YAAYC,CAAAA,CAA2B,CATvC,KAAQ,YAAA,CAA6C,EAAC,CACtD,IAAA,CAAQ,gBAA2C,IAAA,CACnD,IAAA,CAAQ,gBAA2C,IAAA,CACnD,IAAA,CAAQ,mBAAsB,IAAI,GAAA,CAAwB,CAAC,IAAI,CAAC,CAAA,CAChE,IAAA,CAAQ,aAAsB,IAAI,GAAA,CAAY,CAAC,IAAA,CAAM,IAAA,CAAM,IAAA,CAAM,IAAA,CAAM,KAAM,IAAA,CAAM,IAAA,CAAM,IAAI,CAAC,CAAA,CAC9F,KAAQ,SAAA,CAAsB,IAAI,GAAA,CAK1BA,CAAAA,GACA,KAAK,eAAA,CAAkBA,CAAAA,CAAO,iBAAmB,IAAA,CACjD,IAAA,CAAK,gBAAkBA,CAAAA,CAAO,eAAA,EAAmB,IAAA,CACjD,IAAA,CAAK,QAAUA,CAAAA,CAAO,OAAA,CACtB,KAAK,gBAAA,CAAmBA,CAAAA,CAAO,iBAE3BA,CAAAA,CAAO,kBAAA,GACP,IAAA,CAAK,kBAAA,CAAqB,IAAI,GAAA,CAAIA,CAAAA,CAAO,kBAAkB,CAAA,CAAA,EAGvE,CAKA,MAAa,IAAA,EAAsB,CAC/B,GAAI,IAAA,CAAK,QAAS,CACd,IAAMC,EAAS,MAAM,IAAA,CAAK,QAAQ,GAAA,CAAI,eAAe,CAAA,CACjDA,CAAAA,EAAU,KAAK,kBAAA,CAAmB,GAAA,CAAIA,CAAM,CAAA,GAC5C,IAAA,CAAK,gBAAkBA,CAAAA,EAE/B,CACJ,CAaO,YAAA,CAAaC,EAA0BC,CAAAA,CAAyC,CAC9E,KAAK,YAAA,CAAaD,CAAI,IACvB,IAAA,CAAK,YAAA,CAAaA,CAAI,CAAA,CAAI,EAAC,CAAA,CAG/B,IAAME,EAAY,IAAA,CAAK,aAAA,CAAcD,CAAY,CAAA,CACjD,IAAA,CAAK,YAAA,CAAaD,CAAI,EAAI,CAAE,GAAG,KAAK,YAAA,CAAaA,CAAI,EAAG,GAAGE,CAAU,CAAA,CACrE,IAAA,CAAK,mBAAmB,GAAA,CAAIF,CAAI,EACpC,CAMO,gBAAA,CAAiBC,EAA0C,CAC9D,MAAA,CAAO,OAAA,CAAQA,CAAY,EAAE,OAAA,CAAQ,CAAC,CAACD,CAAAA,CAAMG,CAAK,IAAM,CACpD,IAAA,CAAK,YAAA,CAAaH,CAAAA,CAAMG,CAAK,EACjC,CAAC,EACL,CAOQ,aAAA,CAAcC,EAA0BC,CAAAA,CAAiB,EAAA,CAA4B,CACzF,IAAMH,CAAAA,CAAoC,EAAC,CAE3C,IAAA,IAAWI,KAAOF,CAAAA,CAAK,CACnB,GAAI,CAAC,MAAA,CAAO,SAAA,CAAU,cAAA,CAAe,KAAKA,CAAAA,CAAKE,CAAG,EAAG,SAErD,IAAMC,EAAQH,CAAAA,CAAIE,CAAG,CAAA,CACfE,CAAAA,CAASH,EAAS,CAAA,EAAGA,CAAM,IAAIC,CAAG,CAAA,CAAA,CAAKA,EAEzC,OAAOC,CAAAA,EAAU,QAAA,EAAYA,CAAAA,GAAU,MAAQ,CAAC,KAAA,CAAM,QAAQA,CAAK,CAAA,CACnE,OAAO,MAAA,CAAOL,CAAAA,CAAW,IAAA,CAAK,aAAA,CAAcK,EAAOC,CAAM,CAAC,EAE1DN,CAAAA,CAAUM,CAAM,EAAI,MAAA,CAAOD,CAAK,EAExC,CAEA,OAAOL,CACX,CAmBO,EAAEI,CAAAA,CAAaG,CAAAA,CAAiCC,EAA2B,CAE9E,IAAIC,CAAAA,CAAc,IAAA,CAAK,eAAeL,CAAAA,CAAKI,CAAQ,EAEnD,OAAID,CAAAA,EACA,OAAO,OAAA,CAAQA,CAAM,CAAA,CAAE,OAAA,CAAQ,CAAC,CAACG,CAAAA,CAAOL,CAAK,CAAA,GAAM,CAE/C,IAAMM,CAAAA,CAAa,IAAA,CAAK,cAAA,CAAeN,CAAAA,CAAOA,CAAK,CAAA,CACnDI,CAAAA,CAAcA,EAAY,OAAA,CACtB,IAAI,OAAO,CAAA,GAAA,EAAMC,CAAK,CAAA,GAAA,CAAA,CAAO,GAAG,EAChCC,CACJ,EACJ,CAAC,CAAA,CAGEF,CACX,CAMQ,cAAA,CAAeL,CAAAA,CAAaI,CAAAA,CAA2B,CAE3D,OAAI,IAAA,CAAK,YAAA,CAAa,KAAK,eAAe,CAAA,GAAIJ,CAAG,CAAA,CAC/B,IAAA,CAAK,YAAA,CAAa,IAAA,CAAK,eAAe,CAAA,CAAEA,CAAG,EAKzD,IAAA,CAAK,eAAA,GAAoB,KAAK,eAAA,EAC9B,IAAA,CAAK,YAAA,CAAa,IAAA,CAAK,eAAe,CAAA,GAAIA,CAAG,EAC/B,IAAA,CAAK,YAAA,CAAa,KAAK,eAAe,CAAA,CAAEA,CAAG,CAAA,EAK7D,QAAQ,IAAA,CAAK,CAAA,mCAAA,EAAsCA,CAAG,CAAA,SAAA,EAAY,IAAA,CAAK,eAAe,CAAA,CAAA,CAAG,CAAA,CAClFI,CAAAA,EAAYJ,CAAAA,CACvB,CAUO,KAAA,CAAMN,CAAAA,CAA0BM,EAAaG,CAAAA,CAAiCC,CAAAA,CAA2B,CAC5G,IAAMI,CAAAA,CAAW,IAAA,CAAK,eAAA,CACtB,KAAK,eAAA,CAAkBd,CAAAA,CAEvB,IAAMe,CAAAA,CAAS,IAAA,CAAK,EAAET,CAAAA,CAAKG,CAAAA,CAAQC,CAAQ,CAAA,CAE3C,OAAA,IAAA,CAAK,gBAAkBI,CAAAA,CAEhBC,CACX,CAqBO,MAAA,CAAOT,CAAAA,CAAaG,EAAiCC,CAAAA,CAA6C,CACrG,IAAIC,CAAAA,CAAc,KAAK,CAAA,CAAEL,CAAAA,CAAKG,EAAQC,CAAQ,CAAA,CAE9CC,EAAcA,CAAAA,CAAY,OAAA,CAAQ,UAAA,CAAY,MAAM,EAEpD,IAAMK,CAAAA,CAAmC,EAAC,CACpCC,CAAAA,CAAQ,qDACVC,CAAAA,CAEJ,KAAA,CAAQA,CAAAA,CAAQD,CAAAA,CAAM,KAAKN,CAAW,CAAA,IAAO,MACrCO,CAAAA,CAAM,CAAC,EAEPF,CAAAA,CAAO,IAAA,CAAK,CAAE,IAAA,CAAM,OAAQ,OAAA,CAASE,CAAAA,CAAM,CAAC,CAAE,CAAC,EACxCA,CAAAA,CAAM,CAAC,CAAA,CAEdF,CAAAA,CAAO,KAAK,CAAE,IAAA,CAAM,MAAO,GAAA,CAAKE,CAAAA,CAAM,CAAC,CAAA,CAAG,OAAA,CAASA,CAAAA,CAAM,CAAC,CAAE,CAAC,CAAA,CACtDA,EAAM,CAAC,CAAA,EAEdF,EAAO,IAAA,CAAK,CAAE,IAAA,CAAM,KAAA,CAAO,IAAKE,CAAAA,CAAM,CAAC,EAAG,OAAA,CAAS,EAAG,CAAC,CAAA,CAI/D,OAAOF,CAAAA,CAAO,MAAA,CAAS,EAAIA,CAAAA,CAAS,CAAC,CAAE,IAAA,CAAM,MAAA,CAAQ,QAASL,CAAY,CAAC,CAC/E,CAUA,MAAa,WAAA,CAAYX,CAAAA,CAA0BmB,EAAW,IAAA,CAAMC,CAAAA,CAAU,KAAMC,CAAAA,CAAa,IAAA,CAAqB,CAClH,GAAI,CAAC,IAAA,CAAK,kBAAA,CAAmB,IAAIrB,CAAI,CAAA,CAAG,CACpC,OAAA,CAAQ,IAAA,CAAK,CAAA,iBAAA,EAAoBA,CAAI,yCAAyC,CAAA,CAC9E,MACJ,CAEA,IAAA,CAAK,eAAA,CAAkBA,EAGnB,IAAA,CAAK,OAAA,EACL,MAAM,IAAA,CAAK,QAAQ,GAAA,CAAI,eAAA,CAAiBA,CAAI,CAAA,CAI5C,OAAO,SAAa,GAAA,GAEhBqB,CAAAA,EAAaC,CAAAA,CAAU,MAAA,CAAQtB,EAAM,GAAG,CAAA,CAGxCmB,IAAW,QAAA,CAAS,eAAA,CAAgB,KAAOnB,CAAAA,CAAAA,CAG3CoB,CAAAA,GAAU,QAAA,CAAS,eAAA,CAAgB,IAAM,IAAA,CAAK,KAAA,GAAU,KAAA,CAAQ,KAAA,CAAA,CAAA,CAIxE,KAAK,SAAA,CAAU,OAAA,CAAQG,CAAAA,EAAMA,CAAAA,CAAGvB,CAAI,CAAC,CAAA,CAEjC,KAAK,gBAAA,EACL,IAAA,CAAK,iBAAiBA,CAAI,EAElC,CAKO,WAAA,EAAkC,CACrC,OAAO,IAAA,CAAK,eAChB,CAKO,qBAAA,EAA8C,CACjD,OAAO,KAAA,CAAM,IAAA,CAAK,IAAA,CAAK,kBAAkB,CAC7C,CAKO,mBAAA,CAAoBA,EAAmC,CAC1D,OAAO,KAAK,kBAAA,CAAmB,GAAA,CAAIA,CAAI,CAC3C,CAUO,MAAA,CAAOM,CAAAA,CAAsB,CAChC,OAAO,CAAC,EACJ,IAAA,CAAK,YAAA,CAAa,IAAA,CAAK,eAAe,IAAIA,CAAG,CAAA,EAC7C,KAAK,YAAA,CAAa,IAAA,CAAK,eAAe,CAAA,GAAIA,CAAG,CAAA,CAErD,CAKO,iBAA0C,CAC7C,OAAO,KAAK,YAAA,CAAa,IAAA,CAAK,eAAe,CAAA,EAAK,EACtD,CAKO,OAAiB,CACpB,OAAO,KAAK,YAAA,CAAa,GAAA,CAAI,KAAK,eAAA,CAAgB,WAAA,EAAY,CAAE,SAAA,CAAU,EAAG,CAAC,CAAC,CACnF,CAKO,aAAA,CAAcN,EAAmC,CACpD,OAAO,IAAA,CAAK,YAAA,CAAa,IAAIA,CAAAA,CAAK,WAAA,GAAc,SAAA,CAAU,CAAA,CAAG,CAAC,CAAC,CACnE,CAMO,QAAA,CAASwB,CAAAA,CAA0D,CACtE,OAAA,IAAA,CAAK,SAAA,CAAU,IAAIA,CAAQ,CAAA,CACpB,IAAM,IAAA,CAAK,SAAA,CAAU,MAAA,CAAOA,CAAQ,CAC/C,CAIR,EASA,SAASF,CAAAA,CAAUG,CAAAA,CAAclB,EAAemB,CAAAA,CAAc,CAC1D,IAAIC,CAAAA,CAAU,GACJ,CACN,IAAMC,CAAAA,CAAO,IAAI,IAAA,CACjBA,CAAAA,CAAK,OAAA,CAAQA,CAAAA,CAAK,SAAQ,CAAKF,CAAAA,CAAO,GAAK,EAAA,CAAK,EAAA,CAAK,GAAK,CAAA,CAC1DC,CAAAA,CAAU,YAAA,CAAeC,CAAAA,CAAK,cAClC,CACA,SAAS,MAAA,CAASH,CAAAA,CAAO,KAAOlB,CAAAA,EAAS,EAAA,CAAA,CAAMoB,CAAAA,CAAU,WAC7D,CChVA,IAAME,CAAAA,CAAuB,KAA0B,CACnD,GAAA,CAAMvB,GACE,OAAO,YAAA,CAAiB,GAAA,CAAoB,IAAA,CACzC,aAAa,OAAA,CAAQA,CAAG,EAEnC,GAAA,CAAK,CAACA,EAAaC,CAAAA,GAAkB,CAC7B,OAAO,YAAA,CAAiB,KACxB,YAAA,CAAa,OAAA,CAAQD,EAAKC,CAAK,EAEvC,CACJ,CAAA,CAAA,CAKMuB,CAAAA,CAAsB,IAAyB,CACjD,IAAMC,EAAQ,IAAI,GAAA,CAClB,OAAO,CACH,GAAA,CAAMzB,GAAgByB,CAAAA,CAAM,GAAA,CAAIzB,CAAG,CAAA,EAAK,KACxC,GAAA,CAAK,CAACA,EAAaC,CAAAA,GAAkB,CAAEwB,EAAM,GAAA,CAAIzB,CAAAA,CAAKC,CAAK,EAAG,CAClE,CACJ,CAAA,CAKMyB,EAAoB,IACf,OAAO,aAAiB,GAAA,CAAcH,CAAAA,EAAqB,CAAIC,CAAAA,GAO7DG,CAAAA,CAAN,KAAiB,CAQpB,WAAA,CAAYC,CAAAA,CAAiBC,EAAsBC,CAAAA,CAAwB,MAAA,CAAQ,CALnF,IAAA,CAAQ,QAAU,IAAI,GAAA,CACtB,KAAQ,MAAA,CAAS,IAAI,IAKjB,IAAA,CAAK,OAAA,CAAUF,CAAAA,CAAQ,QAAA,CAAS,GAAG,CAAA,CAAIA,CAAAA,CAAUA,EAAU,GAAA,CAC3D,IAAA,CAAK,QAAUC,CAAAA,CACf,IAAA,CAAK,aAAA,CAAgBC,CAAAA,CACrB,KAAK,YAAA,CAAe,OAAO,MAAU,IACzC,CAMA,MAAM,IAAA,CAAKpC,CAAAA,CAAyC,CAIhD,GAAI,KAAK,MAAA,CAAO,GAAA,CAAIA,CAAI,CAAA,CAEpB,OAIJ,GAAI,IAAA,CAAK,OAAA,CAAQ,GAAA,CAAIA,CAAI,EAErB,OAAO,IAAA,CAAK,QAAQ,GAAA,CAAIA,CAAI,EAKhC,IAAMqC,CAAAA,CAAU,IAAA,CAAK,MAAA,CAAOrC,CAAI,CAAA,CAChC,IAAA,CAAK,QAAQ,GAAA,CAAIA,CAAAA,CAAMqC,CAAO,CAAA,CAE9B,GAAI,CACA,MAAMA,EACN,IAAA,CAAK,MAAA,CAAO,IAAIrC,CAAI,EAExB,OAASsC,CAAAA,CAAO,CACZ,OAAA,CAAQ,KAAA,CAAM,wCAAwCtC,CAAI,CAAA,EAAA,CAAA,CAAMsC,CAAK,EACzE,CAAA,OAAE,CACE,IAAA,CAAK,OAAA,CAAQ,MAAA,CAAOtC,CAAI,EAC5B,CACJ,CAEA,MAAc,MAAA,CAAOA,CAAAA,CAAyC,CAC1D,GAAI,CACA,IAAMuC,CAAAA,CAAW,GAAG,IAAA,CAAK,OAAO,GAAGvC,CAAI,CAAA,CAAA,EAAI,KAAK,aAAa,CAAA,CAAA,CAIzDwC,CAAAA,CAGgBD,CAAAA,CAAS,WAAW,GAAG,CAAA,EAAKA,EAAS,UAAA,CAAW,GAAG,GAAK,YAAA,CAAa,IAAA,CAAKA,CAAQ,CAAA,EAGnF,KAAK,YAAA,CAGpBC,CAAAA,CAAO,MAAM,IAAA,CAAK,YAAA,CAAaD,CAAQ,CAAA,CAIvCC,CAAAA,CAAO,MAAM,IAAA,CAAK,WAAA,CAAYD,CAAQ,CAAA,CAGtCC,CAAAA,CAGA,KAAK,OAAA,CAAQ,YAAA,CAAaxC,EAAMwC,CAA2B,CAAA,CAE3D,OAAA,CAAQ,IAAA,CAAK,8CAA8CxC,CAAI,CAAA,CAAA,CAAG,EAE1E,CAAA,MAASsC,CAAAA,CAAO,CACZ,OAAA,CAAQ,IAAA,CAAK,CAAA,+BAAA,EAAkCtC,CAAI,GAAIsC,CAAK,EAChE,CACJ,CAEA,MAAc,YAAYG,CAAAA,CAAqD,CAC3E,GAAI,CACA,IAAMC,CAAAA,CAAW,MAAM,MAAMD,CAAG,CAAA,CAEhC,OAAIC,CAAAA,CAAS,EAAA,CACF,MAAMA,CAAAA,CAAS,MAAK,EAE3B,OAAA,CAAQ,KAAK,CAAA,yCAAA,EAA4CD,CAAG,KAAKC,CAAAA,CAAS,MAAM,CAAA,CAAA,CAAG,CAAA,CAC5E,KAEf,CAAA,MAASJ,CAAAA,CAAO,CACZ,OAAA,OAAA,CAAQ,IAAA,CAAK,mCAAmCG,CAAG,CAAA,CAAA,CAAIH,CAAK,CAAA,CACrD,IACX,CACJ,CAEA,MAAc,YAAA,CAAaC,CAAAA,CAA0D,CACjF,GAAI,CAGA,IAAMI,CAAAA,CAAK,MAAM,OAAO,IAAI,EAAE,IAAA,CAAKC,CAAAA,EAAKA,EAAE,QAAQ,CAAA,CAAE,MAAM,IAAW,IAAI,EAEnEC,CAAAA,CAAO,aAAa,MAAM,CAAA,CAAE,KAAKD,CAAAA,EAAKA,CAAC,CAAA,CAAE,KAAA,CAAM,IAAW,IAAI,CAAA,CAEpE,GAAI,CAACD,CAAAA,CACD,eAAQ,IAAA,CAAK,qDAAqD,CAAA,CAC3D,IAAA,CAIX,IAAIG,CAAAA,CAAeP,CAAAA,CACnB,GAAIM,CAAAA,EAAQ,CAACA,EAAK,UAAA,CAAWN,CAAQ,CAAA,CAAG,CAEpC,IAAMQ,CAAAA,CAAU,aAAa,SAAS,CAAA,CAAE,KAAKH,CAAAA,EAAKA,CAAC,CAAA,CAAE,KAAA,CAAM,IAAW,IAAI,CAAA,CACtEG,IACAD,CAAAA,CAAeD,CAAAA,CAAK,QAAQE,CAAAA,CAAQ,GAAA,EAAI,CAAGR,CAAQ,GAE3D,CAEA,IAAMS,EAAU,MAAML,CAAAA,CAAG,SAASG,CAAAA,CAAc,OAAO,CAAA,CACvD,OAAO,KAAK,KAAA,CAAME,CAAO,CAC7B,CAAA,MAASV,CAAAA,CAAO,CACZ,OAAA,OAAA,CAAQ,IAAA,CAAK,CAAA,2BAAA,EAA8BC,CAAQ,GAAID,CAAK,CAAA,CACrD,IACX,CACJ,CAEA,SAAStC,CAAAA,CAAmC,CACxC,OAAO,IAAA,CAAK,MAAA,CAAO,IAAIA,CAAI,CAC/B,CACJ,CAAA,CAQIiD,CAAAA,CAA+B,KAC/BC,CAAAA,CAAgC,KAOpC,SAASC,CAAAA,EAAgC,CACrC,OAAI,OAAO,UAAc,GAAA,EAAe,SAAA,CAAU,SACvC,SAAA,CAAU,QAAA,CAAS,KAAA,CAAM,GAAG,EAAE,CAAC,CAAA,CAAE,aAAY,CAEjD,IACX,CAMA,SAASC,CAAAA,EAAqB,CAC1B,OAAO,OAAO,KAAA,CAAU,GAAA,EAAe,OAAO,MAAA,CAAW,GAC7D,CAKO,SAASC,CAAAA,EAAuB,CACnC,OAAKJ,IACDA,CAAAA,CAAW,IAAIpD,GAEZoD,CACX,CAKO,SAASK,CAAAA,EAAmC,CAC/C,OAAOJ,CACX,CA0BA,eAAsBK,CAAAA,CAClBzD,EACoB,CAGpB,GAAIsD,GAAU,EAAK,CAACtD,CAAAA,CAAO,eAAA,CAAiB,CACxC,IAAM0D,CAAAA,CAAeL,GAAsB,CACvCrD,CAAAA,CAAO,oBAAoB,QAAA,CAAS0D,CAAY,CAAA,CAChD1D,CAAAA,CAAO,gBAAkB0D,CAAAA,CAEzB1D,CAAAA,CAAO,gBAAkBA,CAAAA,CAAO,kBAAA,GAAqB,CAAC,CAAA,EAAK,KAEnE,CAYA,GATKA,EAAO,OAAA,GACRA,CAAAA,CAAO,QAAUkC,CAAAA,EAAkB,CAAA,CAIvCiB,EAAW,IAAIpD,CAAAA,CAAYC,CAAM,CAAA,CACjC,MAAMmD,CAAAA,CAAS,IAAA,GAGXnD,CAAAA,CAAO,QAAA,CAAU,CACjB,IAAMsC,CAAAA,CAAgBtC,CAAAA,CAAO,aAAA,EAAiB,OAC9CoD,CAAAA,CAAa,IAAIjB,EAAWnC,CAAAA,CAAO,QAAA,CAAUmD,EAAUb,CAAa,CAAA,CACpE,MAAMc,CAAAA,CAAW,KAAKD,CAAAA,CAAS,WAAA,EAAa,EAChD,CAGA,OAAIG,CAAAA,EAAU,GACV,QAAA,CAAS,eAAA,CAAgB,KAAOH,CAAAA,CAAS,WAAA,GACzC,QAAA,CAAS,eAAA,CAAgB,IAAMA,CAAAA,CAAS,KAAA,EAAM,CAAI,KAAA,CAAQ,OAGvDA,CACX,KAaaQ,CAAAA,CAAI,CAACnD,EAAaG,CAAAA,CAAiCC,CAAAA,GAC5D2C,CAAAA,EAAQ,CAAE,EAAE/C,CAAAA,CAAKG,CAAAA,CAAQC,CAAQ,CAAA,CAKxBgD,CAAAA,CAAQ,CAAC1D,CAAAA,CAA0BM,CAAAA,CAAaG,CAAAA,CAAiCC,CAAAA,GAC1F2C,GAAQ,CAAE,KAAA,CAAMrD,EAAMM,CAAAA,CAAKG,CAAAA,CAAQC,CAAQ,CAAA,CAMlCiD,CAAAA,CAAa,MAAO3D,CAAAA,CAA0BM,CAAAA,CAAaG,EAAiCC,CAAAA,IAIjGwC,CAAAA,EAAc,CAACA,CAAAA,CAAW,QAAA,CAASlD,CAAI,CAAA,EAEvC,MAAMkD,CAAAA,CAAW,IAAA,CAAKlD,CAAI,CAAA,CAQfqD,CAAAA,GAAU,KAAA,CAAMrD,CAAAA,CAAMM,EAAKG,CAAAA,CAAQC,CAAQ,CAAA,CAAA,CAQjDkD,CAAAA,CAAS,CAACtD,CAAAA,CAAaG,CAAAA,CAAiCC,IACjE2C,CAAAA,EAAQ,CAAE,OAAO/C,CAAAA,CAAKG,CAAAA,CAAQC,CAAQ,CAAA,CAK7BmD,EAAc,CAAC7D,CAAAA,CAA0BmB,EAAW,IAAA,CAAMC,CAAAA,CAAU,KAAMC,CAAAA,CAAa,IAAA,GAE5F6B,CAAAA,EAAc,CAACA,EAAW,QAAA,CAASlD,CAAI,EAChCkD,CAAAA,CAAW,IAAA,CAAKlD,CAAI,CAAA,CAAE,IAAA,CAAK,IAAMqD,CAAAA,GAAU,WAAA,CAAYrD,CAAAA,CAAMmB,EAAUC,CAAAA,CAASC,CAAU,CAAC,CAAA,CAE/FgC,CAAAA,EAAQ,CAAE,WAAA,CAAYrD,EAAMmB,CAAAA,CAAUC,CAAAA,CAASC,CAAU,CAAA,CAMvDyC,CAAAA,CAAc,IACvBT,CAAAA,EAAQ,CAAE,WAAA,EAAY,CAKbU,EAAwB,IACjCV,CAAAA,GAAU,qBAAA,EAAsB,CAKvBW,EAAU1D,CAAAA,EACnB+C,CAAAA,GAAU,MAAA,CAAO/C,CAAG,EAKX2D,CAAAA,CAAQ,IACjBZ,GAAQ,CAAE,KAAA,GAKDa,CAAAA,CAAiBlE,CAAAA,EAC1BqD,CAAAA,EAAQ,CAAE,cAAcrD,CAAI,CAAA,CAKnBmE,EAAY3C,CAAAA,EACrB6B,CAAAA,GAAU,QAAA,CAAS7B,CAAQ,CAAA,CAMlB4C,CAAAA,CAAe,CAACpE,CAAAA,CAA0BC,CAAAA,GACnDoD,GAAQ,CAAE,YAAA,CAAarD,EAAMC,CAAY,CAAA,CAKhCoE,CAAAA,CAAoBpE,CAAAA,EAC7BoD,GAAQ,CAAE,gBAAA,CAAiBpD,CAAY,EAepC,SAASqE,EAAOC,CAAAA,CAAeC,CAAAA,CAAmBC,CAAAA,CAA2B,CAEhF,OAAOhB,CAAAA,CADKc,CAAAA,GAAU,EAAIC,CAAAA,CAAYC,CAAAA,CACxB,CAAE,KAAA,CAAO,MAAA,CAAOF,CAAK,CAAE,CAAC,CAC1C,KAQOG,CAAAA,CAAQ,CACX,UAAAnB,CAAAA,CACA,OAAA,CAAAF,CAAAA,CACA,aAAA,CAAAC,EACA,WAAA,CAAAzD,CAAAA,CACA,WAAAoC,CAAAA,CACA,CAAA,CAAAwB,EACA,KAAA,CAAAC,CAAAA,CACA,MAAA,CAAAE,CAAAA,CACA,YAAAC,CAAAA,CACA,WAAA,CAAAC,EACA,qBAAA,CAAAC,CAAAA,CACA,OAAAC,CAAAA,CACA,KAAA,CAAAC,EACA,aAAA,CAAAC,CAAAA,CACA,SAAAC,CAAAA,CACA,YAAA,CAAAC,EACA,gBAAA,CAAAC,CAAAA,CACA,OAAAC,CACJ","file":"index.js","sourcesContent":["// src/mod/i18n.ts\r\n//\r\n// Made with ❤️ by Maysara.\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ PACK ════════════════════════════════════════╗\r\n\r\n    import * as types from '../types';\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ CORE ════════════════════════════════════════╗\r\n\r\n    export class I18nManager {\r\n\r\n        // ┌──────────────────────────────── INIT ──────────────────────────────┐\r\n\r\n            private translations        : types.TranslationSet = {};\r\n            private currentLanguage     : types.LanguageCode = 'en';\r\n            private defaultLanguage     : types.LanguageCode = 'en';\r\n            private supportedLanguages  = new Set<types.LanguageCode>(['en']);\r\n            private rtlLanguages        = new Set<string>(['ar', 'he', 'fa', 'ur', 'yi', 'ji', 'iw', 'ku']);\r\n            private listeners           = new Set<(lang: types.LanguageCode) => void>();\r\n            private storage?            : types.I18nStorage;\r\n            private onLanguageChange?   : (lang: types.LanguageCode) => void;\r\n\r\n            constructor(config?: types.I18nConfig) {\r\n                if (config) {\r\n                    this.defaultLanguage = config.defaultLanguage || 'en';\r\n                    this.currentLanguage = config.defaultLanguage || 'en';\r\n                    this.storage = config.storage;\r\n                    this.onLanguageChange = config.onLanguageChange;\r\n\r\n                    if (config.supportedLanguages) {\r\n                        this.supportedLanguages = new Set(config.supportedLanguages);\r\n                    }\r\n                }\r\n            }\r\n\r\n            /**\r\n             * Initialize with stored language preference\r\n             */\r\n            public async init(): Promise<void> {\r\n                if (this.storage) {\r\n                    const stored = await this.storage.get('i18n-language');\r\n                    if (stored && this.supportedLanguages.has(stored)) {\r\n                        this.currentLanguage = stored;\r\n                    }\r\n                }\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n\r\n        // ┌──────────────────────────────── LOAD ──────────────────────────────┐\r\n\r\n            /**\r\n             * Load translations for a specific language\r\n             * @param lang Language code\r\n             * @param translations Translation object (can be nested)\r\n             */\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            public loadLanguage(lang: types.LanguageCode, translations: Record<string, any>): void {\r\n                if (!this.translations[lang]) {\r\n                    this.translations[lang] = {};\r\n                }\r\n\r\n                const flattened = this.flattenObject(translations);\r\n                this.translations[lang] = { ...this.translations[lang], ...flattened };\r\n                this.supportedLanguages.add(lang);\r\n            }\r\n\r\n            /**\r\n             * Load multiple languages at once\r\n             * @param translations Object with language codes as keys\r\n             */\r\n            public loadTranslations(translations: types.TranslationSet): void {\r\n                Object.entries(translations).forEach(([lang, trans]) => {\r\n                    this.loadLanguage(lang, trans);\r\n                });\r\n            }\r\n\r\n            /**\r\n             * Flatten nested object into dot notation\r\n             * @private\r\n             */\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            private flattenObject(obj: Record<string, any>, prefix: string = ''): Record<string, string> {\r\n                const flattened: Record<string, string> = {};\r\n\r\n                for (const key in obj) {\r\n                    if (!Object.prototype.hasOwnProperty.call(obj, key)) continue;\r\n\r\n                    const value = obj[key];\r\n                    const newKey = prefix ? `${prefix}.${key}` : key;\r\n\r\n                    if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\r\n                        Object.assign(flattened, this.flattenObject(value, newKey));\r\n                    } else {\r\n                        flattened[newKey] = String(value);\r\n                    }\r\n                }\r\n\r\n                return flattened;\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n\r\n        // ┌───────────────────────────── TRANSLATION ──────────────────────────┐\r\n\r\n            /**\r\n             * Translate a key with parameter replacement\r\n             *\r\n             * @example\r\n             * t('welcome.message', { name: 'John' })\r\n             * // => \"Welcome, John!\"\r\n             *\r\n             * @param key Translation key (dot notation)\r\n             * @param params Optional parameters for replacement\r\n             * @param fallback Optional fallback string if key not found\r\n             * @returns Translated string\r\n             */\r\n            public t(key: string, params?: Record<string, string>, fallback?: string): string {\r\n\r\n                let translation = this.getTranslation(key, fallback);\r\n\r\n                if (params) {\r\n                    Object.entries(params).forEach(([param, value]) => {\r\n                        // Check if parameter value is itself a translation key\r\n                        const paramValue = this.getTranslation(value, value);\r\n                        translation = translation.replace(\r\n                            new RegExp(`\\\\{${param}\\\\}`, 'g'),\r\n                            paramValue\r\n                        );\r\n                    });\r\n                }\r\n\r\n                return translation;\r\n            }\r\n\r\n            /**\r\n             * Get raw translation without parameter replacement\r\n             * @private\r\n             */\r\n            private getTranslation(key: string, fallback?: string): string {\r\n                // Try current language\r\n                if (this.translations[this.currentLanguage]?.[key]) {\r\n                    const value = this.translations[this.currentLanguage][key];\r\n                    return value;\r\n                }\r\n\r\n                // Try default language\r\n                if (this.defaultLanguage !== this.currentLanguage &&\r\n                    this.translations[this.defaultLanguage]?.[key]) {\r\n                    const value = this.translations[this.defaultLanguage][key];\r\n                    return value;\r\n                }\r\n\r\n                // Warn and return fallback\r\n                console.warn(`[i18n] Translation key not found: \"${key}\" (lang: ${this.currentLanguage})`);\r\n                return fallback || key;\r\n            }\r\n\r\n            /**\r\n             * Translate with a specific language temporarily\r\n             *\r\n             * @param lang Language code\r\n             * @param key Translation key\r\n             * @param params Optional parameters\r\n             * @param fallback Optional fallback string if key not found\r\n             */\r\n            public tLang(lang: types.LanguageCode, key: string, params?: Record<string, string>, fallback?: string): string {\r\n                const original = this.currentLanguage;\r\n                this.currentLanguage = lang;\r\n                \r\n                const result = this.t(key, params, fallback);\r\n                \r\n                this.currentLanguage = original;\r\n                \r\n                return result;\r\n            }\r\n\r\n            /**\r\n             * Translate and parse HTML-like tags into tokens\r\n             * Converts \\n or /n to line breaks\r\n             *\r\n             * @example\r\n             * // Translation: \"Hello\\nWorld <strong>here</strong>\"\r\n             * tParse('message')\r\n             * // => [\r\n             * //   { type: 'text', content: 'Hello' },\r\n             * //   { type: 'tag', tag: 'br', content: '' },\r\n             * //   { type: 'text', content: 'World ' },\r\n             * //   { type: 'tag', tag: 'strong', content: 'here' }\r\n             * // ]\r\n             *\r\n             * @param key Translation key\r\n             * @param params Optional parameters\r\n             * @param fallback Optional fallback string if key not found\r\n             * @returns Array of tokens\r\n             */\r\n            public tParse(key: string, params?: Record<string, string>, fallback?: string): types.TranslationToken[] {\r\n                let translation = this.t(key, params, fallback);\r\n                // Convert newlines to <br> tags\r\n                translation = translation.replace(/\\\\n|\\/n/g, '<br>');\r\n\r\n                const tokens: types.TranslationToken[] = [];\r\n                const regex = /<([a-z]+)>([^<]*)<\\/\\1>|<([a-z]+)\\s*\\/?>|([^<]+)/gi;\r\n                let match;\r\n\r\n                while ((match = regex.exec(translation)) !== null) {\r\n                    if (match[4]) {\r\n                        // Plain text\r\n                        tokens.push({ type: 'text', content: match[4] });\r\n                    } else if (match[1]) {\r\n                        // Paired tag: <strong>text</strong>\r\n                        tokens.push({ type: 'tag', tag: match[1], content: match[2] });\r\n                    } else if (match[3]) {\r\n                        // Self-closing: <br> or <br/>\r\n                        tokens.push({ type: 'tag', tag: match[3], content: '' });\r\n                    }\r\n                }\r\n\r\n                return tokens.length > 0 ? tokens : [{ type: 'text', content: translation }];\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n\r\n        // ┌────────────────────────────── LANGUAGE ────────────────────────────┐\r\n\r\n            /**\r\n             * Set current language\r\n             */\r\n            public async setLanguage(lang: types.LanguageCode, _setLang = true, _setDir = true, _setCookie = true): Promise<void> {\r\n                if (!this.supportedLanguages.has(lang)) {\r\n                    console.warn(`[i18n] Language \"${lang}\" not supported, aborting setLanguage()`);\r\n                    return;\r\n                }\r\n\r\n                this.currentLanguage = lang;\r\n\r\n                // Persist if storage available\r\n                if (this.storage) {\r\n                    await this.storage.set('i18n-language', lang);\r\n                }\r\n\r\n                // client\r\n                if( typeof document !== 'undefined' ) {\r\n                    // cookie\r\n                    if( _setCookie ) setCookie('lang', lang, 365);\r\n\r\n                    // html lang attribute\r\n                    if( _setLang ) document.documentElement.lang = lang;\r\n\r\n                    // dir attr\r\n                    if( _setDir ) document.documentElement.dir = this.isRTL() ? 'rtl' : 'ltr';\r\n                }\r\n\r\n                // Notify listeners\r\n                this.listeners.forEach(fn => fn(lang));\r\n\r\n                if (this.onLanguageChange) {\r\n                    this.onLanguageChange(lang);\r\n                }\r\n            }\r\n\r\n            /**\r\n             * Get current language\r\n             */\r\n            public getLanguage(): types.LanguageCode {\r\n                return this.currentLanguage;\r\n            }\r\n\r\n            /**\r\n             * Get all supported languages\r\n             */\r\n            public getSupportedLanguages(): types.LanguageCode[] {\r\n                return Array.from(this.supportedLanguages);\r\n            }\r\n\r\n            /**\r\n             * Check if language is supported\r\n             */\r\n            public isLanguageSupported(lang: types.LanguageCode): boolean {\r\n                return this.supportedLanguages.has(lang);\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n\r\n        // ┌─────────────────────────────── HELPERS ────────────────────────────┐\r\n\r\n            /**\r\n             * Check if a translation key exists\r\n             */\r\n            public hasKey(key: string): boolean {\r\n                return !!(\r\n                    this.translations[this.currentLanguage]?.[key] ||\r\n                    this.translations[this.defaultLanguage]?.[key]\r\n                );\r\n            }\r\n\r\n            /**\r\n             * Get all translations for current language\r\n             */\r\n            public getTranslations(): Record<string, string> {\r\n                return this.translations[this.currentLanguage] || {};\r\n            }\r\n\r\n            /**\r\n             * Check if current language is RTL\r\n             */\r\n            public isRTL(): boolean {\r\n                return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0, 2));\r\n            }\r\n\r\n            /**\r\n             * Check if specific language is RTL\r\n             */\r\n            public isRTLLanguage(lang: types.LanguageCode): boolean {\r\n                return this.rtlLanguages.has(lang.toLowerCase().substring(0, 2));\r\n            }\r\n\r\n            /**\r\n             * Subscribe to language changes\r\n             * @returns Unsubscribe function\r\n             */\r\n            public onChange(callback: (lang: types.LanguageCode) => void): () => void {\r\n                this.listeners.add(callback);\r\n                return () => this.listeners.delete(callback);\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n    }\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ HELP ════════════════════════════════════════╗\r\n\r\n    // Function to set a cookie with name, value, and days to expire\r\n    function setCookie(name: string, value: string, days: number) {\r\n        let expires = \"\";\r\n        if (days) {\r\n            const date = new Date();\r\n            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\r\n            expires = \"; expires=\" + date.toUTCString();\r\n        }\r\n        document.cookie = name + \"=\" + (value || \"\") + expires + \"; path=/\";\r\n    }\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n","// src/index.ts\r\n//\r\n// Made with ❤️ by Maysara.\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ PACK ════════════════════════════════════════╗\r\n\r\n    import * as types from './types';\r\n    import { I18nManager } from './mod/i18n';\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ CORE ════════════════════════════════════════╗\r\n\r\n    /**\r\n     * Storage adapter for browser (localStorage)\r\n     */\r\n    const createBrowserStorage = (): types.I18nStorage => ({\r\n        get: (key: string) => {\r\n            if (typeof localStorage === 'undefined') return null;\r\n            return localStorage.getItem(key);\r\n        },\r\n        set: (key: string, value: string) => {\r\n            if (typeof localStorage !== 'undefined') {\r\n                localStorage.setItem(key, value);\r\n            }\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Storage adapter for memory (in-process storage)\r\n     */\r\n    const createMemoryStorage = (): types.I18nStorage => {\r\n        const store = new Map<string, string>();\r\n        return {\r\n            get: (key: string) => store.get(key) || null,\r\n            set: (key: string, value: string) => { store.set(key, value); }\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Auto-select appropriate storage based on environment\r\n     */\r\n    const getDefaultStorage = (): types.I18nStorage => {\r\n        return typeof localStorage !== 'undefined' ? createBrowserStorage() : createMemoryStorage();\r\n    };\r\n\r\n    /**\r\n     * Lazy loader: fetch language on-demand\r\n     * Supports both URL-based (browser) and file-based (server) loading\r\n     */\r\n    export class LazyLoader {\r\n        private baseUrl: string;\r\n        private manager: I18nManager;\r\n        private loading = new Map<types.LanguageCode, Promise<void>>();\r\n        private loaded = new Set<types.LanguageCode>();\r\n        private isServerSide: boolean;\r\n        private fileExtension: string;\r\n\r\n        constructor(baseUrl: string, manager: I18nManager, fileExtension: string = 'json') {\r\n            this.baseUrl = baseUrl.endsWith('/') ? baseUrl : baseUrl + '/';\r\n            this.manager = manager;\r\n            this.fileExtension = fileExtension;\r\n            this.isServerSide = typeof fetch === 'undefined';\r\n        }\r\n\r\n        /**\r\n         * Load a language file on-demand\r\n         * Caches the promise to prevent duplicate requests\r\n         */\r\n        async load(lang: types.LanguageCode): Promise<void> {\r\n           // console.log(`[LazyLoader] load() called for language: \"${lang}\"`);\r\n\r\n            // Already loaded\r\n            if (this.loaded.has(lang)) {\r\n               // console.log(`[LazyLoader] Language \"${lang}\" already loaded, returning immediately`);\r\n                return;\r\n            }\r\n\r\n            // Currently loading\r\n            if (this.loading.has(lang)) {\r\n               // console.log(`[LazyLoader] Language \"${lang}\" is currently loading, returning existing promise`);\r\n                return this.loading.get(lang);\r\n            }\r\n\r\n            // Start loading\r\n           // console.log(`[LazyLoader] Starting to load language: \"${lang}\"`);\r\n            const promise = this.doLoad(lang);\r\n            this.loading.set(lang, promise);\r\n\r\n            try {\r\n                await promise;\r\n                this.loaded.add(lang);\r\n               // console.log(`[LazyLoader] Language \"${lang}\" loaded and marked as loaded`);\r\n            } catch (error) {\r\n                console.error(`[LazyLoader] Error loading language \"${lang}\":`, error);\r\n            } finally {\r\n                this.loading.delete(lang);\r\n            }\r\n        }\r\n\r\n        private async doLoad(lang: types.LanguageCode): Promise<void> {\r\n            try {\r\n                const filePath = `${this.baseUrl}${lang}.${this.fileExtension}`;\r\n               // console.log(`[LazyLoader] doLoad() - filePath: \"${filePath}\"`);\r\n               // console.log(`[LazyLoader] isServerSide: ${this.isServerSide}`);\r\n\r\n                let data: Record<string, string> | null;\r\n\r\n                // Check if it's a local file path (relative or absolute)\r\n                const isLocalPath = filePath.startsWith('.') || filePath.startsWith('/') || /^[a-zA-Z]:/.test(filePath);\r\n               // console.log(`[LazyLoader] isLocalPath: ${isLocalPath}`);\r\n\r\n                if (isLocalPath || this.isServerSide) {\r\n                    // Node.js/local: Read from filesystem\r\n                   // console.log(`[LazyLoader] Loading from file...`);\r\n                    data = await this.loadFromFile(filePath);\r\n                } else {\r\n                    // Browser: Fetch from URL\r\n                   // console.log(`[LazyLoader] Loading from URL...`);\r\n                    data = await this.loadFromUrl(filePath);\r\n                }\r\n\r\n                if (data) {\r\n                   // console.log(`[LazyLoader] Data loaded successfully, keys:`, Object.keys(data).length);\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    this.manager.loadLanguage(lang, data as Record<string, any>);\r\n                } else {\r\n                    console.warn(`[LazyLoader] No data loaded for language: \"${lang}\"`);\r\n                }\r\n            } catch (error) {\r\n                console.warn(`[i18n] Error loading language: ${lang}`, error);\r\n            }\r\n        }\r\n\r\n        private async loadFromUrl(url: string): Promise<Record<string, string> | null> {\r\n            try {\r\n                const response = await fetch(url);\r\n\r\n                if (response.ok) {\r\n                    return await response.json();\r\n                } else {\r\n                    console.warn(`[i18n] Failed to load language from URL: ${url} (${response.status})`);\r\n                    return null;\r\n                }\r\n            } catch (error) {\r\n                console.warn(`[i18n] Error fetching from URL: ${url}`, error);\r\n                return null;\r\n            }\r\n        }\r\n\r\n        private async loadFromFile(filePath: string): Promise<Record<string, string> | null> {\r\n            try {\r\n                // Dynamic import to avoid issues in browsers\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                const fs = await import('fs').then(m => m.promises).catch((): any => null);\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                const path = await import('path').then(m => m).catch((): any => null);\r\n\r\n                if (!fs) {\r\n                    console.warn('[i18n] fs module not available. Running in browser?');\r\n                    return null;\r\n                }\r\n\r\n                // Resolve relative paths to absolute paths\r\n                let resolvedPath = filePath;\r\n                if (path && !path.isAbsolute(filePath)) {\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    const process = await import('process').then(m => m).catch((): any => null);\r\n                    if (process) {\r\n                        resolvedPath = path.resolve(process.cwd(), filePath);\r\n                    }\r\n                }\r\n\r\n                const content = await fs.readFile(resolvedPath, 'utf-8');\r\n                return JSON.parse(content);\r\n            } catch (error) {\r\n                console.warn(`[i18n] Error reading file: ${filePath}`, error);\r\n                return null;\r\n            }\r\n        }\r\n\r\n        isLoaded(lang: types.LanguageCode): boolean {\r\n            return this.loaded.has(lang);\r\n        }\r\n    }\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ ════ ════════════════════════════════════════╗\r\n\r\n    let instance: I18nManager | null = null;\r\n    let lazyLoader: LazyLoader | null = null;\r\n\r\n    /**\r\n     * Get browser language preference\r\n     * Uses navigator.language if available (browser environment)\r\n     * @private\r\n     */\r\n    function detectBrowserLanguage(): string {\r\n        if (typeof navigator !== 'undefined' && navigator.language) {\r\n            return navigator.language.split('-')[0].toLowerCase();\r\n        }\r\n        return 'en';\r\n    }\r\n\r\n    /**\r\n     * Check if running in browser environment\r\n     * @private\r\n     */\r\n    function isBrowser(): boolean {\r\n        return typeof fetch !== 'undefined' && typeof window !== 'undefined';\r\n    }\r\n\r\n    /**\r\n     * Get or create the global i18n instance\r\n     */\r\n    export function getI18n(): I18nManager {\r\n        if (!instance) {\r\n            instance = new I18nManager();\r\n        }\r\n        return instance;\r\n    }\r\n\r\n    /**\r\n     * Get the lazy loader instance (only available after setupI18n with basePath)\r\n     */\r\n    export function getLazyLoader(): LazyLoader | null {\r\n        return lazyLoader;\r\n    }\r\n\r\n    /**\r\n     * Main setup function - Single, simple, auto-detecting initialization\r\n     *\r\n     * Auto-detects environment and handles both browser and server:\r\n     * - Browser: Auto-detects language, loads from URL path\r\n     * - Server: Uses defaultLanguage, loads from file system\r\n     *\r\n     * Call this ONCE at app startup.\r\n     *\r\n     * @example\r\n     * // Browser - Auto-detects language, lazy-loads from URL\r\n     * await setupI18n({\r\n     *   supportedLanguages: ['en', 'ar', 'fr'],\r\n     *   basePath: '/i18n/'\r\n     * });\r\n     *\r\n     * @example\r\n     * // Server - Uses default language, lazy-loads from filesystem\r\n     * await setupI18n({\r\n     *   defaultLanguage: 'en',\r\n     *   supportedLanguages: ['en', 'ar', 'fr'],\r\n     *   basePath: './locales/'\r\n     * });\r\n     */\r\n    export async function setupI18n(\r\n        config: types.I18nConfig & { basePath?: string }\r\n    ): Promise<I18nManager> {\r\n\r\n        // Auto-detect browser language if in browser and no defaultLanguage specified\r\n        if (isBrowser() && !config.defaultLanguage) {\r\n            const detectedLang = detectBrowserLanguage();\r\n            if (config.supportedLanguages?.includes(detectedLang)) {\r\n                config.defaultLanguage = detectedLang;\r\n            } else {\r\n                config.defaultLanguage = config.supportedLanguages?.[0] || 'en';\r\n            }\r\n        }\r\n\r\n        // Use appropriate storage based on environment\r\n        if (!config.storage) {\r\n            config.storage = getDefaultStorage();\r\n        }\r\n\r\n        // Create and initialize manager\r\n        instance = new I18nManager(config);\r\n        await instance.init();\r\n\r\n        // Setup lazy loading if basePath provided\r\n        if (config.basePath) {\r\n            const fileExtension = config.fileExtension || 'json';\r\n            lazyLoader = new LazyLoader(config.basePath, instance, fileExtension);\r\n            await lazyLoader.load(instance.getLanguage());\r\n        }\r\n\r\n        // set lang in html\r\n        if (isBrowser()) {\r\n            document.documentElement.lang = instance.getLanguage();\r\n            document.documentElement.dir = instance.isRTL() ? 'rtl' : 'ltr';\r\n        }\r\n\r\n        return instance;\r\n    }\r\n\r\n\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ CONVENIENCE FUNCTIONS ════════════════════════════════════════╗\r\n\r\n    /**\r\n     * Translate a key with optional parameter replacement\r\n     */\r\n    export const t = (key: string, params?: Record<string, string>, fallback?: string) =>\r\n        getI18n().t(key, params, fallback);\r\n\r\n    /**\r\n     * Translate a key with a specific language temporarily\r\n     */\r\n    export const tLang = (lang: types.LanguageCode, key: string, params?: Record<string, string>, fallback?: string) =>\r\n        getI18n().tLang(lang, key, params, fallback);\r\n\r\n    /**\r\n     * Translate a key with a specific language - async version that loads language if needed\r\n     * Use this on server-side with lazy loading to ensure language is loaded first\r\n     */\r\n    export const tLangAsync = async (lang: types.LanguageCode, key: string, params?: Record<string, string>, fallback?: string): Promise<string> => {\r\n        // console.log(`[i18n] tLangAsync() called: lang=\"${lang}\", key=\"${key}\"`);\r\n\r\n        // Load language if lazy loader available\r\n        if (lazyLoader && !lazyLoader.isLoaded(lang)) {\r\n            // console.log(`[i18n] Language \"${lang}\" not loaded, loading now...`);\r\n            await lazyLoader.load(lang);\r\n            // console.log(`[i18n] Language \"${lang}\" loaded successfully`);\r\n        } else if (lazyLoader) {\r\n            // console.log(`[i18n] Language \"${lang}\" already loaded`);\r\n        } else {\r\n            // console.log(`[i18n] No LazyLoader available`);\r\n        }\r\n\r\n        const result = getI18n().tLang(lang, key, params, fallback);\r\n        // console.log(`[i18n] tLangAsync() result: \"${result}\"`);\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Parse translation with HTML tags into tokens\r\n     */\r\n    export const tParse = (key: string, params?: Record<string, string>, fallback?: string) =>\r\n        getI18n().tParse(key, params, fallback);\r\n\r\n    /**\r\n     * Set current language and trigger listeners\r\n     */\r\n    export const setLanguage = (lang: types.LanguageCode, _setLang = true, _setDir = true, _setCookie = true): Promise<void> => {\r\n        // Load language if lazy loader available\r\n        if (lazyLoader && !lazyLoader.isLoaded(lang)) {\r\n            return lazyLoader.load(lang).then(() => getI18n().setLanguage(lang, _setLang, _setDir, _setCookie));\r\n        }\r\n        return getI18n().setLanguage(lang, _setLang, _setDir, _setCookie);\r\n    };\r\n\r\n    /**\r\n     * Get current language code\r\n     */\r\n    export const getLanguage = () =>\r\n        getI18n().getLanguage();\r\n\r\n    /**\r\n     * Get all supported languages\r\n     */\r\n    export const getSupportedLanguages = () =>\r\n        getI18n().getSupportedLanguages();\r\n\r\n    /**\r\n     * Check if translation key exists\r\n     */\r\n    export const hasKey = (key: string) =>\r\n        getI18n().hasKey(key);\r\n\r\n    /**\r\n     * Check if current language is RTL\r\n     */\r\n    export const isRTL = () =>\r\n        getI18n().isRTL();\r\n\r\n    /**\r\n     * Check if specific language is RTL\r\n     */\r\n    export const isRTLLanguage = (lang: types.LanguageCode) =>\r\n        getI18n().isRTLLanguage(lang);\r\n\r\n    /**\r\n     * Subscribe to language changes\r\n     */\r\n    export const onChange = (callback: (lang: types.LanguageCode) => void) =>\r\n        getI18n().onChange(callback);\r\n\r\n    /**\r\n     * Load translations for a specific language\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    export const loadLanguage = (lang: types.LanguageCode, translations: Record<string, any>) =>\r\n        getI18n().loadLanguage(lang, translations);\r\n\r\n    /**\r\n     * Load multiple languages at once\r\n     */\r\n    export const loadTranslations = (translations: types.TranslationSet) =>\r\n        getI18n().loadTranslations(translations);\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ UTILITY FUNCTIONS ════════════════════════════════════════╗\r\n\r\n    /**\r\n     * Pluralization helper - select translation based on count\r\n     *\r\n     * @example\r\n     * plural(1, 'item.single', 'item.plural') // \"1 item\"\r\n     * plural(5, 'item.single', 'item.plural') // \"5 items\"\r\n     */\r\n    export function plural(count: number, singleKey: string, pluralKey: string): string {\r\n        const key = count === 1 ? singleKey : pluralKey;\r\n        return t(key, { count: String(count) });\r\n    }\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ EXPORTS ════════════════════════════════════════╗\r\n\r\n    export default {\r\n        setupI18n,\r\n        getI18n,\r\n        getLazyLoader,\r\n        I18nManager,\r\n        LazyLoader,\r\n        t,\r\n        tLang,\r\n        tParse,\r\n        setLanguage,\r\n        getLanguage,\r\n        getSupportedLanguages,\r\n        hasKey,\r\n        isRTL,\r\n        isRTLLanguage,\r\n        onChange,\r\n        loadLanguage,\r\n        loadTranslations,\r\n        plural,\r\n    };\r\n\r\n    export type I18nManagerInstance = InstanceType<typeof I18nManager>;\r\n    export type LazyLoaderInstance = InstanceType<typeof LazyLoader>;\r\n\r\n    export * from './mod/i18n';\r\n    export * from './types';\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n"]}