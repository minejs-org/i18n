'use strict';Object.defineProperty(exports,'__esModule',{value:true});var u=class{constructor(t){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.fallbackLanguage="en";this.supportedLanguages=new Set(["en"]);this.rtlLanguages=new Set(["ar","he","fa","ur","yi","ji","iw","ku"]);this.listeners=new Set;t&&(this.defaultLanguage=t.defaultLanguage||"en",this.fallbackLanguage=t.fallbackLanguage||t.defaultLanguage||"en",this.currentLanguage=t.defaultLanguage||"en",this.storage=t.storage,this.onLanguageChange=t.onLanguageChange,t.supportedLanguages&&(this.supportedLanguages=new Set(t.supportedLanguages)));}async init(){if(this.storage){let t=await this.storage.get("i18n-language");t&&this.supportedLanguages.has(t)&&(this.currentLanguage=t);}}loadLanguage(t,e){this.translations[t]||(this.translations[t]={});let a=this.flattenObject(e);this.translations[t]={...this.translations[t],...a},this.supportedLanguages.add(t);}loadTranslations(t){Object.entries(t).forEach(([e,a])=>{this.loadLanguage(e,a);});}flattenObject(t,e=""){let a={};for(let s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;let r=t[s],i=e?`${e}.${s}`:s;typeof r=="object"&&r!==null&&!Array.isArray(r)?Object.assign(a,this.flattenObject(r,i)):a[i]=String(r);}return a}t(t,e){let a=this.getTranslation(t);return e&&Object.entries(e).forEach(([s,r])=>{let i=this.getTranslation(r,r);a=a.replace(new RegExp(`\\{${s}\\}`,"g"),i);}),a}getTranslation(t,e){return this.translations[this.currentLanguage]?.[t]?this.translations[this.currentLanguage][t]:this.fallbackLanguage!==this.currentLanguage&&this.translations[this.fallbackLanguage]?.[t]?this.translations[this.fallbackLanguage][t]:this.defaultLanguage!==this.currentLanguage&&this.defaultLanguage!==this.fallbackLanguage&&this.translations[this.defaultLanguage]?.[t]?this.translations[this.defaultLanguage][t]:(console.warn(`[i18n] Translation key not found: "${t}" (lang: ${this.currentLanguage})`),e||t)}tLang(t,e,a){let s=this.currentLanguage;this.currentLanguage=e;let r=this.t(t,a);return this.currentLanguage=s,r}tParse(t,e){let a=this.t(t,e);a=a.replace(/\\n|\/n/g,"<br>");let s=[],r=/<([a-z]+)>([^<]*)<\/\1>|<([a-z]+)\s*\/?>|([^<]+)/gi,i;for(;(i=r.exec(a))!==null;)i[4]?s.push({type:"text",content:i[4]}):i[1]?s.push({type:"tag",tag:i[1],content:i[2]}):i[3]&&s.push({type:"tag",tag:i[3],content:""});return s.length>0?s:[{type:"text",content:a}]}async setLanguage(t){if(!this.supportedLanguages.has(t)){console.warn(`[i18n] Language "${t}" not supported`);return}this.currentLanguage=t,this.storage&&await this.storage.set("i18n-language",t),this.listeners.forEach(e=>e(t)),this.onLanguageChange&&this.onLanguageChange(t);}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}isLanguageSupported(t){return this.supportedLanguages.has(t)}hasKey(t){return !!(this.translations[this.currentLanguage]?.[t]||this.translations[this.fallbackLanguage]?.[t]||this.translations[this.defaultLanguage]?.[t])}getTranslations(){return this.translations[this.currentLanguage]||{}}isRTL(){return this.rtlLanguages.has(this.currentLanguage.toLowerCase().substring(0,2))}isRTLLanguage(t){return this.rtlLanguages.has(t.toLowerCase().substring(0,2))}onChange(t){return this.listeners.add(t),()=>this.listeners.delete(t)}},h={get:n=>typeof localStorage>"u"?null:localStorage.getItem(n),set:(n,t)=>{typeof localStorage<"u"&&localStorage.setItem(n,t);}},L=(()=>{let n=new Map;return {get:t=>n.get(t)||null,set:(t,e)=>{n.set(t,e);}}})();async function f(n,t){let e=Array.isArray(n)?n:[n],a={};for(let s of e)try{let r=await fetch(s);if(r.ok){let i=await r.json(),p=s.match(/([a-z]{2,3})\.json$/i),d=p?p[1].toLowerCase():"en";a[d]=i;}}catch(r){console.warn(`[i18n] Failed to fetch: ${s}`,r);}Object.keys(a).length>0&&t.loadTranslations(a);}var l=class{constructor(t,e,a="json"){this.loading=new Map;this.loaded=new Set;this.baseUrl=t.endsWith("/")?t:t+"/",this.manager=e,this.fileExtension=a,this.isServerSide=typeof fetch>"u";}async load(t){if(this.loaded.has(t))return;if(this.loading.has(t))return this.loading.get(t);let e=this.doLoad(t);this.loading.set(t,e);try{await e,this.loaded.add(t);}finally{this.loading.delete(t);}}async doLoad(t){try{let e=`${this.baseUrl}${t}.${this.fileExtension}`,a;this.isServerSide?a=await this.loadFromFile(e):a=await this.loadFromUrl(e),a&&this.manager.loadLanguage(t,a);}catch(e){console.warn(`[i18n] Error loading language: ${t}`,e);}}async loadFromUrl(t){try{let e=await fetch(t);return e.ok?await e.json():(console.warn(`[i18n] Failed to load language from URL: ${t} (${e.status})`),null)}catch(e){return console.warn(`[i18n] Error fetching from URL: ${t}`,e),null}}async loadFromFile(t){try{let e=await import('fs').then(s=>s.promises).catch(()=>null);if(!e)return console.warn("[i18n] fs module not available. Running in browser?"),null;let a=await e.readFile(t,"utf-8");return JSON.parse(a)}catch(e){return console.warn(`[i18n] Error reading file: ${t}`,e),null}}isLoaded(t){return this.loaded.has(t)}},g=null;function o(){return g||(g=new u),g}async function y(n){return g=new u(n),await g.init(),g}function b(n,t="json"){return new l(n,o(),t)}async function w(n){let t=new u(n);await t.init(),g=t;let e=n.basePath||n.baseUrl||"./locales/",a=n.fileExtension||"json",s=new l(e,t,a);return await s.load(t.getLanguage()),s}async function m(n){let t=new u(n);await t.init(),g=t;let e=n.fileExtension||"json",a=new l(n.basePath,t,e);return await a.load(t.getLanguage()),a}var c=(n,t)=>o().t(n,t),S=(n,t,e)=>o().tLang(n,t,e),T=(n,t)=>o().tParse(n,t),R=n=>o().setLanguage(n),I=()=>o().getLanguage(),P=()=>o().getSupportedLanguages(),$=n=>o().hasKey(n),x=()=>o().isRTL(),j=n=>o().isRTLLanguage(n),E=n=>o().onChange(n),M=(n,t)=>o().loadLanguage(n,t),O=n=>o().loadTranslations(n);function C(n,t="page."){let e=c("app.name"),a=c(t+n);return x()?`${e} - ${a}`:`${a} - ${e}`}function v(n,t,e){return c(n===1?t:e,{count:String(n)})}var k={I18nManager:u,getI18n:o,setupI18n:y,createLazyLoader:b,setupLazy:w,setupAuto:m,browserStorage:h,memoryStorage:L,fetchTranslations:f,genPageTitle:C,plural:v};exports.I18nManager=u;exports.LazyLoader=l;exports.browserStorage=h;exports.createLazyLoader=b;exports.default=k;exports.fetchTranslations=f;exports.genPageTitle=C;exports.getI18n=o;exports.getLanguage=I;exports.getSupportedLanguages=P;exports.hasKey=$;exports.isRTL=x;exports.isRTLLanguage=j;exports.loadLanguage=M;exports.loadTranslations=O;exports.memoryStorage=L;exports.onChange=E;exports.plural=v;exports.setLanguage=R;exports.setupAuto=m;exports.setupI18n=y;exports.setupLazy=w;exports.t=c;exports.tLang=S;exports.tParse=T;//# sourceMappingURL=main.cjs.map
//# sourceMappingURL=main.cjs.map